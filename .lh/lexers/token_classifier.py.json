{
    "sourceFile": "lexers/token_classifier.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1768867276342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768867311197,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,8 @@\n         \"TABLE_TYPE\", \"IF\", \"BULK\"\r\n     }\r\n KEYWORDS = {\r\n     # T-SQL Reserved (Official SQL Server)\r\n-    \"ADD\",\"ALL\",\"ALTER\",\"AND\",\"ANY\",\"AS\",\"ASC\",\"AUTHORIZATION\",\"BACKUP\",\"BEGIN\",\"BETWEEN\",\r\n     \"BREAK\",\"BROWSE\",\"BULK\",\"BY\",\"CASCADE\",\"CASE\",\"CHECK\",\"CHECKPOINT\",\"CLOSE\",\"CLUSTERED\",\r\n     \"COALESCE\",\"COLLATE\",\"COLUMN\",\"COMMIT\",\"COMPUTE\",\"CONSTRAINT\",\"CONTAINS\",\"CONTAINSTABLE\",\r\n     \"CONTINUE\",\"CONVERT\",\"CREATE\",\"CROSS\",\"CURRENT\",\"CURRENT_DATE\",\"CURRENT_TIME\",\r\n     \"CURRENT_TIMESTAMP\",\"CURRENT_USER\",\"CURSOR\",\"DATABASE\",\"DBCC\",\"DEALLOCATE\",\"DECLARE\",\r\n"
                },
                {
                    "date": 1768867322820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,8 +28,9 @@\n         \"TABLE_TYPE\", \"IF\", \"BULK\"\r\n     }\r\n KEYWORDS = {\r\n     # T-SQL Reserved (Official SQL Server)\r\n+    \"ADD\",\"ALL\",\"ALTER\",\"AND\",\"ANY\",\"AS\",\"ASC\",\"AUTHORIZATION\",\"BACKUP\",\"BEGIN\",\"BETWEEN\",\r\n     \"BREAK\",\"BROWSE\",\"BULK\",\"BY\",\"CASCADE\",\"CASE\",\"CHECK\",\"CHECKPOINT\",\"CLOSE\",\"CLUSTERED\",\r\n     \"COALESCE\",\"COLLATE\",\"COLUMN\",\"COMMIT\",\"COMPUTE\",\"CONSTRAINT\",\"CONTAINS\",\"CONTAINSTABLE\",\r\n     \"CONTINUE\",\"CONVERT\",\"CREATE\",\"CROSS\",\"CURRENT\",\"CURRENT_DATE\",\"CURRENT_TIME\",\r\n     \"CURRENT_TIMESTAMP\",\"CURRENT_USER\",\"CURSOR\",\"DATABASE\",\"DBCC\",\"DEALLOCATE\",\"DECLARE\",\r\n"
                },
                {
                    "date": 1768867331946,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n \r\n class TokenClassifier:\r\n     \"\"\"Classifies and validates tokens\"\"\"\r\n \r\n+\r\n     KEYWORDS = {\r\n         \"ADD\", \"ALL\", \"ALTER\", \"AND\", \"ANY\", \"AS\", \"ASC\", \"BETWEEN\", \"BY\", \"CASE\", \"CHECK\",\r\n         \"COLUMN\", \"CONSTRAINT\", \"CREATE\", \"CROSS\", \"DATABASE\", \"DEFAULT\", \"DELETE\",\r\n         \"DESC\", \"DISTINCT\", \"DROP\", \"ELSE\", \"END\", \"EXCEPT\", \"EXISTS\", \"FALSE\", \"FETCH\",\r\n"
                },
                {
                    "date": 1768867353134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,8 @@\n     \"\"\"Classifies and validates tokens\"\"\"\r\n \r\n \r\n     KEYWORDS = {\r\n-        \"COLUMN\", \"CONSTRAINT\", \"CREATE\", \"CROSS\", \"DATABASE\", \"DEFAULT\", \"DELETE\",\r\n         \"DESC\", \"DISTINCT\", \"DROP\", \"ELSE\", \"END\", \"EXCEPT\", \"EXISTS\", \"FALSE\", \"FETCH\",\r\n         \"FOREIGN\", \"FROM\", \"FULL\", \"GROUP\", \"HAVING\", \"ILIKE\", \"IN\", \"INDEX\", \"INNER\",\r\n         \"INSERT\", \"INTERSECT\", \"INTO\", \"IS\", \"JOIN\", \"LEFT\", \"LIKE\", \"LIMIT\", \"NATURAL\",\r\n         \"NOT\", \"NULL\", \"OFFSET\", \"ON\", \"OR\", \"ORDER\", \"OUTER\", \"OVER\", \"PARTITION\",\r\n"
                },
                {
                    "date": 1768867394583,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,11 +3,11 @@\n \r\n class TokenClassifier:\r\n     \"\"\"Classifies and validates tokens\"\"\"\r\n \r\n+      \"FALSE\", \"FETCH\",\r\n \r\n     KEYWORDS = {\r\n-      \"FALSE\", \"FETCH\",\r\n         \"FOREIGN\", \"FROM\", \"FULL\", \"GROUP\", \"HAVING\", \"ILIKE\", \"IN\", \"INDEX\", \"INNER\",\r\n         \"INSERT\", \"INTERSECT\", \"INTO\", \"IS\", \"JOIN\", \"LEFT\", \"LIKE\", \"LIMIT\", \"NATURAL\",\r\n         \"NOT\", \"NULL\", \"OFFSET\", \"ON\", \"OR\", \"ORDER\", \"OUTER\", \"OVER\", \"PARTITION\",\r\n         \"PRIMARY\", \"RETURNING\", \"RIGHT\", \"ROW\", \"ROWS\", \"SELECT\", \"SET\", \"TABLE\",\r\n"
                }
            ],
            "date": 1768867276342,
            "name": "Commit-0",
            "content": "from typing import List, Tuple, Dict\r\n\r\n\r\nclass TokenClassifier:\r\n    \"\"\"Classifies and validates tokens\"\"\"\r\n\r\n    KEYWORDS = {\r\n        \"ADD\", \"ALL\", \"ALTER\", \"AND\", \"ANY\", \"AS\", \"ASC\", \"BETWEEN\", \"BY\", \"CASE\", \"CHECK\",\r\n        \"COLUMN\", \"CONSTRAINT\", \"CREATE\", \"CROSS\", \"DATABASE\", \"DEFAULT\", \"DELETE\",\r\n        \"DESC\", \"DISTINCT\", \"DROP\", \"ELSE\", \"END\", \"EXCEPT\", \"EXISTS\", \"FALSE\", \"FETCH\",\r\n        \"FOREIGN\", \"FROM\", \"FULL\", \"GROUP\", \"HAVING\", \"ILIKE\", \"IN\", \"INDEX\", \"INNER\",\r\n        \"INSERT\", \"INTERSECT\", \"INTO\", \"IS\", \"JOIN\", \"LEFT\", \"LIKE\", \"LIMIT\", \"NATURAL\",\r\n        \"NOT\", \"NULL\", \"OFFSET\", \"ON\", \"OR\", \"ORDER\", \"OUTER\", \"OVER\", \"PARTITION\",\r\n        \"PRIMARY\", \"RETURNING\", \"RIGHT\", \"ROW\", \"ROWS\", \"SELECT\", \"SET\", \"TABLE\",\r\n        \"THEN\", \"TOP\", \"TRUE\", \"UNION\", \"UNIQUE\", \"UNNEST\", \"UPDATE\", \"USING\", \"VALUES\",\r\n        \"WHEN\", \"WHERE\", \"WINDOW\", \"WITH\", \"VIEW\", \"TRIGGER\", \"FUNCTION\", \"PROCEDURE\",\r\n        \"BEGIN\", \"LOOP\", \"REFERENCES\", \"GRANT\", \"REVOKE\", \"TEMP\", \"TEMPORARY\",\r\n        \"REPLACE\", \"MATERIALIZED\", \"ESCAPE\", \"DECLARE\", \"KEY\", \"FIRST\", \"ONLY\",\r\n        \"TRY\", \"CATCH\", \"EXEC\", \"GO\", \"QUOTENAME\", \"RAISERROR\", \"NVARCHAR\", \"INT\",\r\n        \"BIGINT\", \"MAX\", \"ERROR_MESSAGE\", \"ERROR_SEVERITY\", \"ERROR_STATE\",\r\n        \"SCHEMA_NAME\", \"SCHEMA\", \"OBJECT\", \"TYPE\", \"INFORMATION_SCHEMA\",\r\n        \"TABLES\", \"BASE\", \"COLUMNS\", \"KEYS\", \"PARENT\", \"CONSTRAINTS\",\r\n        \"NCHAR\", \"VARCHAR\", \"CHAR\", \"DATETIME\", \"DATE\", \"TIME\", \"FLOAT\", \"REAL\",\r\n        \"NUMERIC\", \"MONEY\", \"SMALLMONEY\", \"BIT\", \"TINYINT\", \"SMALLINT\",\r\n        \"CURSOR\", \"IDENTITY\", \"SEQUENCES\", \"OUTPUT\", \"OPENROWSET\", \"OPENJSON\",\r\n        \"SP_EXECUTESQL\", \"FOREIGN_KEYS\", \"PARENT_OBJECT_ID\", \"EXECPT\",\r\n        \"OBJECT_ID\", \"OBJECT_NAME\", \"OBJECT_SCHEMA_NAME\", \"TABLE_SCHEMA\", \"TABLE_NAME\",\r\n        \"TABLE_TYPE\", \"IF\", \"BULK\"\r\n    }\r\nKEYWORDS = {\r\n    # T-SQL Reserved (Official SQL Server)\r\n    \"ADD\",\"ALL\",\"ALTER\",\"AND\",\"ANY\",\"AS\",\"ASC\",\"AUTHORIZATION\",\"BACKUP\",\"BEGIN\",\"BETWEEN\",\r\n    \"BREAK\",\"BROWSE\",\"BULK\",\"BY\",\"CASCADE\",\"CASE\",\"CHECK\",\"CHECKPOINT\",\"CLOSE\",\"CLUSTERED\",\r\n    \"COALESCE\",\"COLLATE\",\"COLUMN\",\"COMMIT\",\"COMPUTE\",\"CONSTRAINT\",\"CONTAINS\",\"CONTAINSTABLE\",\r\n    \"CONTINUE\",\"CONVERT\",\"CREATE\",\"CROSS\",\"CURRENT\",\"CURRENT_DATE\",\"CURRENT_TIME\",\r\n    \"CURRENT_TIMESTAMP\",\"CURRENT_USER\",\"CURSOR\",\"DATABASE\",\"DBCC\",\"DEALLOCATE\",\"DECLARE\",\r\n    \"DEFAULT\",\"DELETE\",\"DENY\",\"DESC\",\"DISK\",\"DISTINCT\",\"DISTRIBUTED\",\"DOUBLE\",\"DROP\",\"DUMP\",\r\n    \"ELSE\",\"END\",\"ERRLVL\",\"ESCAPE\",\"EXCEPT\",\"EXEC\",\"EXECUTE\",\"EXISTS\",\"EXIT\",\"EXTERNAL\",\"FETCH\",\r\n    \"FILE\",\"FILLFACTOR\",\"FOR\",\"FOREIGN\",\"FREETEXT\",\"FREETEXTTABLE\",\"FROM\",\"FULL\",\"FUNCTION\",\r\n    \"GOTO\",\"GRANT\",\"GROUP\",\"HAVING\",\"HOLDLOCK\",\"IDENTITY\",\"IDENTITY_INSERT\",\"IDENTITYCOL\",\r\n    \"IF\",\"IN\",\"INDEX\",\"INNER\",\"INSERT\",\"INTERSECT\",\"INTO\",\"IS\",\"JOIN\",\"KEY\",\"KILL\",\"LEFT\",\r\n    \"LIKE\",\"LINENO\",\"LOAD\",\"MERGE\",\"NATIONAL\",\"NOCHECK\",\"NONCLUSTERED\",\"NOT\",\"NULL\",\"NULLIF\",\r\n    \"OF\",\"OFF\",\"OFFSETS\",\"ON\",\"OPEN\",\"OPENDATASOURCE\",\"OPENQUERY\",\"OPENROWSET\",\"OPENXML\",\r\n    \"OPTION\",\"OR\",\"ORDER\",\"OUTER\",\"OVER\",\"PERCENT\",\"PLAN\",\"PRECISION\",\"PRIMARY\",\"PRINT\",\r\n    \"PROC\",\"PROCEDURE\",\"PUBLIC\",\"RAISERROR\",\"READ\",\"READTEXT\",\"RECONFIGURE\",\"REFERENCES\",\r\n    \"REPLICATION\",\"RESTORE\",\"RESTRICT\",\"RETURN\",\"REVERT\",\"REVOKE\",\"RIGHT\",\"ROLLBACK\",\"ROWCOUNT\",\r\n    \"ROWGUIDCOL\",\"RULE\",\"SAVE\",\"SAVEPOINT\",\"SCHEMA\",\"SESSION_USER\",\"SET\",\"SETUSER\",\"SHUTDOWN\",\r\n    \"SOME\",\"STATISTICS\",\"SYSTEM_USER\",\"TABLE\",\"TABLESAMPLE\",\"TEXTSIZE\",\"THEN\",\"TO\",\"TOP\",\r\n    \"TRAN\",\"TRANSACTION\",\"TRIGGER\",\"TRUNCATE\",\"TSEQUAL\",\"UNION\",\"UNIQUE\",\"UNPIVOT\",\"UPDATE\",\r\n    \"UPDATETEXT\",\"USE\",\"USER\",\"VALUES\",\"VARYING\",\"VIEW\",\"WAITFOR\",\"WHEN\",\"WHERE\",\"WHILE\",\r\n    \"WITH\",\"WRITETEXT\",\r\n\r\n    # SQL Server Future/Extended or Common Keywords\r\n    \"ABS\",\"ABSENT\",\"ACTION\",\"ADMIN\",\"AFTER\",\"AGGREGATE\",\"ALIAS\",\"ASSERTION\",\"AT\",\"BEFORE\",\r\n    \"BINARY\",\"BIT\",\"BOOLEAN\",\"BOTH\",\"CALL\",\"CAST\",\"CHAR\",\"CHARACTER\",\"CLASS\",\"CLOB\",\"COLUMN_NAME\",\r\n    \"CONNECTION\",\"CONSTRAINTS\",\"CUBE\",\"CURRENT_PATH\",\"DATA\",\"DAY\",\"DECIMAL\",\"DOMAIN\",\r\n    \"ELEMENT\",\"END_EXEC\",\"EXTRACT\",\"FREE\",\"GLOBAL\",\"HOST\",\"HOUR\",\"IDENTIFIER\",\"INTERVAL\",\r\n    \"ISOLATION\",\"LANGUAGE\",\"LAST\",\"LATERAL\",\"LEADING\",\"LEVEL\",\"LOCAL\",\"LOCK\",\"MATCH\",\r\n    \"MINUTE\",\"MONTH\",\"NAMES\",\"NEW\",\"NEXT\",\"ONLY\",\"PARAMETER\",\"POWER\",\"PRECISION\",\"POSITION\",\r\n    \"PROCEDURE_CATALOG\",\"QUARTER\",\"REPEATABLE\",\"RESTRICT\",\"RLIKE\",\"ROLLUP\",\"ROW\",\"ROWS\",\r\n    \"SAVEPOINT\",\"SECOND\",\"SESSION\",\"SCOPE\",\"SEARCH\",\"SECTION\",\"SIMILAR\",\"SQL\",\"SQLSTATE\",\r\n    \"SQLWARNING\",\"START\",\"STATE\",\"STATEMENT\",\"SUBSTRING\",\"SYSTEM\",\"SYSTEM_USER\",\"TERMINATE\",\r\n    \"TIMEZONE_HOUR\",\"TIMEZONE_MINUTE\",\"TRUE\",\"TYPE\",\"UNBOUNDED\",\"UNKNOWN\",\"USAGE\",\"USING\",\r\n    \"VARIABLE\",\"WHENEVER\",\"WITHOUT\",\"YEAR\",\"ZONE\",\r\n\r\n    # Builtâ€‘in Functions / Aggregates\r\n    \"ABS\",\"ACOS\",\"ASIN\",\"ATAN\",\"ATAN2\",\"CEILING\",\"CHARINDEX\",\"CONCAT\",\"COUNT\",\"COUNT_BIG\",\r\n    \"DATEADD\",\"DATEDIFF\",\"DATENAME\",\"DATEPART\",\"GETDATE\",\"ISNULL\",\"LEFT\",\"LEN\",\"LOWER\",\r\n    \"MAX\",\"MIN\",\"POWER\",\"RANK\",\"ROW_NUMBER\",\"RTRIM\",\"SUBSTRING\",\"SUM\",\"UPPER\",\r\n\r\n    # Data Types\r\n    \"BIGINT\",\"BINARY\",\"BIT\",\"CHAR\",\"DATE\",\"DATETIME\",\"DECIMAL\",\"FLOAT\",\"IMAGE\",\"INT\",\r\n    \"MONEY\",\"NCHAR\",\"NTEXT\",\"NUMERIC\",\"REAL\",\"SMALLINT\",\"SMALLMONEY\",\"SQL_VARIANT\",\r\n    \"TEXT\",\"TIME\",\"TIMESTAMP\",\"UNIQUEIDENTIFIER\",\"VARBINARY\",\"VARCHAR\",\"XML\"\r\n}\r\n\r\n    def __init__(self):\r\n        self.errors: List[str] = []\r\n        self.warnings: List[str] = []\r\n\r\n    def classify_tokens(self, tokens: List[Tuple]) -> Dict[str, int]:\r\n        \"\"\"Classify tokens and return statistics\"\"\"\r\n        stats = {}\r\n        for line, col, ttype, text in tokens:\r\n            stats[ttype] = stats.get(ttype, 0) + 1\r\n        return stats\r\n\r\n    def validate_syntax(self, tokens: List[Tuple], input_text: str):\r\n        \"\"\"Validate basic syntax rules\"\"\"\r\n        self.errors.clear()\r\n        self.warnings.clear()\r\n\r\n        self._check_parentheses(tokens)\r\n        self._check_brackets(tokens)\r\n        self._check_identifiers(tokens)\r\n        self._check_strings(tokens)\r\n        self._check_comments(input_text)\r\n\r\n    def _check_parentheses(self, tokens: List[Tuple]):\r\n        \"\"\"Check for balanced parentheses\"\"\"\r\n        paren_count = 0\r\n        for line, col, ttype, text in tokens:\r\n            if text == '(':\r\n                paren_count += 1\r\n            elif text == ')':\r\n                paren_count -= 1\r\n                if paren_count < 0:\r\n                    self.errors.append(\r\n                        f\"Line {line}, Column {col}: Closing parenthesis ) without opening\"\r\n                    )\r\n                    paren_count = 0\r\n\r\n        if paren_count > 0:\r\n            self.errors.append(f\"Error: {paren_count} unclosed opening parenthesis\")\r\n\r\n    def _check_brackets(self, tokens: List[Tuple]):\r\n        \"\"\"Check for balanced brackets\"\"\"\r\n        bracket_count = 0\r\n        for line, col, ttype, text in tokens:\r\n            if text == '[':\r\n                bracket_count += 1\r\n            elif text == ']':\r\n                bracket_count -= 1\r\n                if bracket_count < 0:\r\n                    self.errors.append(\r\n                        f\"Line {line}, Column {col}: Closing bracket ] without opening\"\r\n                    )\r\n                    bracket_count = 0\r\n\r\n        if bracket_count > 0:\r\n            self.errors.append(f\"Error: {bracket_count} unclosed opening bracket\")\r\n\r\n    def _check_identifiers(self, tokens: List[Tuple]):\r\n        \"\"\"Validate identifiers\"\"\"\r\n        for line, col, ttype, text in tokens:\r\n            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                if \"'\" in text and not text.startswith('['):\r\n                    self.warnings.append(\r\n                        f\"Line {line}, Column {col}: Identifier '{text}' contains apostrophe - \"\r\n                        \"consider using bracket notation [...]\"\r\n                    )\r\n\r\n            if text.startswith('[') and text.endswith(']'):\r\n                if \"'\" in text:\r\n                    self.warnings.append(\r\n                        f\"Line {line}, Column {col}: Bracket identifier {text} contains apostrophe\"\r\n                    )\r\n\r\n    def _check_strings(self, tokens: List[Tuple]):\r\n        \"\"\"Validate string literals\"\"\"\r\n        for line, col, ttype, text in tokens:\r\n            if ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n                if \"''\" in text[1:-1]:\r\n                    self.warnings.append(\r\n                        f\"Line {line}, Column {col}: String contains escaped single quotes\"\r\n                    )\r\n                if '\"\"' in text[1:-1]:\r\n                    self.warnings.append(\r\n                        f\"Line {line}, Column {col}: String contains escaped double quotes\"\r\n                    )\r\n\r\n                if '\\\\' in text and ('\\n' in text or '\\r' in text):\r\n                    self.warnings.append(\r\n                        f\"Line {line}, Column {col}: String contains line continuation\"\r\n                    )\r\n\r\n    def _check_comments(self, input_text: str):\r\n        \"\"\"Check for balanced block comments\"\"\"\r\n        comment_depth = 0\r\n        lines = input_text.split('\\n')\r\n        for line_num, line in enumerate(lines, 1):\r\n            i = 0\r\n            while i < len(line) - 1:\r\n                if line[i:i + 2] == '/*':\r\n                    comment_depth += 1\r\n                    i += 2\r\n                elif line[i:i + 2] == '*/':\r\n                    comment_depth -= 1\r\n                    if comment_depth < 0:\r\n                        self.errors.append(\r\n                            f\"Line {line_num}: Closing comment */ without opening /*\"\r\n                        )\r\n                        comment_depth = 0\r\n                    i += 2\r\n                else:\r\n                    i += 1\r\n\r\n        if comment_depth > 0:\r\n            self.errors.append(f\"Error: {comment_depth} unclosed block comment(s)\")"
        }
    ]
}