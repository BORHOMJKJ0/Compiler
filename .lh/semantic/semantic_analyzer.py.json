{
    "sourceFile": "semantic/semantic_analyzer.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1768913356023,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768913361178,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,9 +40,8 @@\n         i = 0\r\n         while i < len(tokens):\r\n             line, col, ttype, text = tokens[i]\r\n \r\n-            # Track literal statistics\r\n             if ttype == \"HEX_STRING\":\r\n                 self.stats['hex_strings'] += 1\r\n                 self.stats['total_literals'] += 1\r\n                 self._validate_hex_string(line, col, text)\r\n"
                },
                {
                    "date": 1768913368141,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,9 +97,8 @@\n                 f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n                 \"WARNING\")\r\n \r\n     def _validate_bit_string(self, line: int, col: int, text: str):\r\n-        \"\"\"Validate bit string format\"\"\"\r\n         bit_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n \r\n         invalid_chars = [c for c in bit_part if c not in '01']\r\n \r\n"
                },
                {
                    "date": 1768913375538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,17 +29,15 @@\n             'total_literals': 0\r\n         }\r\n \r\n     def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n-        \"\"\"Add an error or warning\"\"\"\r\n         error = SemanticError(line, column, message, severity)\r\n         if severity == \"ERROR\":\r\n             self.errors.append(error)\r\n         elif severity == \"WARNING\":\r\n             self.warnings.append(error)\r\n \r\n     def analyze_tokens(self, tokens: List[Tuple]):\r\n-        \"\"\"Analyze a list of tokens\"\"\"\r\n         i = 0\r\n         while i < len(tokens):\r\n             line, col, ttype, text = tokens[i]\r\n \r\n@@ -60,9 +58,8 @@\n             elif ttype == \"NUMBER\":\r\n                 self.stats['numbers'] += 1\r\n                 self.stats['total_literals'] += 1\r\n \r\n-            # Analyze statements\r\n             if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n                 i = self._analyze_create_table(tokens, i)\r\n \r\n             elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n@@ -84,9 +81,8 @@\n \r\n         return self.errors, self.warnings\r\n \r\n     def _validate_hex_string(self, line: int, col: int, text: str):\r\n-        \"\"\"Validate hex string format\"\"\"\r\n         hex_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n \r\n         valid_hex = set('0123456789abcdefABCDEF')\r\n         invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n@@ -111,9 +107,8 @@\n                 f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n                 \"ERROR\")\r\n \r\n     def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze CREATE TABLE statement\"\"\"\r\n         i = start + 1\r\n \r\n         while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n             i += 1\r\n@@ -125,9 +120,8 @@\n \r\n         schema = \"dbo\"\r\n         table_name = first.strip('[]')\r\n \r\n-        # check for schema.table\r\n         if i + 2 < len(tokens):\r\n             if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                 schema = table_name.upper()\r\n                 table_name = tokens[i + 2][3].strip('[]')\r\n@@ -149,9 +143,8 @@\n \r\n         return i\r\n \r\n     def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n-        \"\"\"Parse column definitions\"\"\"\r\n         i = start\r\n \r\n         while i < len(tokens):\r\n             line, col, ttype, text = tokens[i]\r\n"
                },
                {
                    "date": 1768913380969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,9 +201,8 @@\n \r\n         line, col, ttype, table_name = tokens[i]\r\n         raw_name = table_name.strip('[]')\r\n \r\n-        # Parse schema if exists\r\n         schema = \"dbo\"\r\n         if '.' in raw_name:\r\n             parts = raw_name.split('.')\r\n             schema = parts[0].upper()\r\n"
                },
                {
                    "date": 1768913386055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -253,9 +253,8 @@\n         if i < len(tokens):\r\n             line, col, ttype, table_name = tokens[i]\r\n             raw_name = table_name.strip('[]')\r\n \r\n-            # Parse schema if exists\r\n             schema = \"dbo\"\r\n             if '.' in raw_name:\r\n                 parts = raw_name.split('.')\r\n                 schema = parts[0].upper()\r\n"
                },
                {
                    "date": 1768913391584,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -305,9 +305,8 @@\n \r\n         return i\r\n \r\n     def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze SELECT statement\"\"\"\r\n         i = start + 1\r\n \r\n         while i < len(tokens):\r\n             if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n"
                },
                {
                    "date": 1768913397879,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -360,9 +360,8 @@\n \r\n         return i + 1\r\n \r\n     def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze SET statement\"\"\"\r\n         i = start + 1\r\n \r\n         if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n             line, col, ttype, var_name = tokens[i]\r\n"
                },
                {
                    "date": 1768913404237,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,426 @@\n+from typing import List, Tuple\r\n+from dataclasses import dataclass\r\n+from .symbol_table import SymbolTable, Table, Column, Variable\r\n+\r\n+\r\n+@dataclass\r\n+class SemanticError:\r\n+    line: int\r\n+    column: int\r\n+    message: str\r\n+    severity: str = \"ERROR\"\r\n+\r\n+    def __str__(self):\r\n+        return f\"[{self.severity}] Line {self.line}, Col {self.column}: {self.message}\"\r\n+\r\n+\r\n+class SemanticAnalyzer:\r\n+\r\n+    def __init__(self):\r\n+        self.symbol_table = SymbolTable()\r\n+        self.errors: List[SemanticError] = []\r\n+        self.warnings: List[SemanticError] = []\r\n+\r\n+        self.stats = {\r\n+            'hex_strings': 0,\r\n+            'bit_strings': 0,\r\n+            'regular_strings': 0,\r\n+            'numbers': 0,\r\n+            'total_literals': 0\r\n+        }\r\n+\r\n+    def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n+        error = SemanticError(line, column, message, severity)\r\n+        if severity == \"ERROR\":\r\n+            self.errors.append(error)\r\n+        elif severity == \"WARNING\":\r\n+            self.warnings.append(error)\r\n+\r\n+    def analyze_tokens(self, tokens: List[Tuple]):\r\n+        i = 0\r\n+        while i < len(tokens):\r\n+            line, col, ttype, text = tokens[i]\r\n+\r\n+            if ttype == \"HEX_STRING\":\r\n+                self.stats['hex_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+                self._validate_hex_string(line, col, text)\r\n+\r\n+            elif ttype == \"BIT_STRING\":\r\n+                self.stats['bit_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+                self._validate_bit_string(line, col, text)\r\n+\r\n+            elif ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n+                self.stats['regular_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+\r\n+            elif ttype == \"NUMBER\":\r\n+                self.stats['numbers'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+\r\n+            if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n+                i = self._analyze_create_table(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n+                i = self._analyze_alter_table(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"UPDATE\":\r\n+                i = self._analyze_update(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"SELECT\":\r\n+                i = self._analyze_select(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"DECLARE\":\r\n+                i = self._analyze_declare(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"SET\":\r\n+                i = self._analyze_set(tokens, i)\r\n+\r\n+            i += 1\r\n+\r\n+        return self.errors, self.warnings\r\n+\r\n+    def _validate_hex_string(self, line: int, col: int, text: str):\r\n+        hex_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n+\r\n+        valid_hex = set('0123456789abcdefABCDEF')\r\n+        invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n+\r\n+        if invalid_chars:\r\n+            self.add_error(line, col,\r\n+                f\"Invalid characters in hex string: {set(invalid_chars)}\",\r\n+                \"ERROR\")\r\n+\r\n+        if len(hex_part) % 2 != 0:\r\n+            self.add_error(line, col,\r\n+                f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n+                \"WARNING\")\r\n+\r\n+    def _validate_bit_string(self, line: int, col: int, text: str):\r\n+        bit_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n+\r\n+        invalid_chars = [c for c in bit_part if c not in '01']\r\n+\r\n+        if invalid_chars:\r\n+            self.add_error(line, col,\r\n+                f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n+                \"ERROR\")\r\n+\r\n+    def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+            i += 1\r\n+\r\n+        if i >= len(tokens):\r\n+            return i\r\n+\r\n+        line, col, ttype, first = tokens[i]\r\n+\r\n+        schema = \"dbo\"\r\n+        table_name = first.strip('[]')\r\n+\r\n+        if i + 2 < len(tokens):\r\n+            if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                schema = table_name.upper()\r\n+                table_name = tokens[i + 2][3].strip('[]')\r\n+                i += 2\r\n+\r\n+        schema = schema.upper()\r\n+        table_name = table_name.upper()\r\n+\r\n+        full_table_name = f\"{schema.upper()}.{table_name.upper()}\"\r\n+\r\n+        if self.symbol_table.has_table(table_name, schema):\r\n+            self.add_error(line, col,\r\n+                f\"Table '{table_name}' already exists\", \"WARNING\")\r\n+        else:\r\n+            table = Table(table_name, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            i = self._parse_columns(tokens, i + 1, table)\r\n+\r\n+        return i\r\n+\r\n+    def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n+        i = start\r\n+\r\n+        while i < len(tokens):\r\n+            line, col, ttype, text = tokens[i]\r\n+\r\n+            if text == ')':\r\n+                break\r\n+\r\n+            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                col_name = text.strip('[]')\r\n+\r\n+                if \"'\" in col_name:\r\n+                    self.add_error(line, col,\r\n+                        f\"Column name '{col_name}' contains apostrophe - consider using bracket notation\",\r\n+                        \"WARNING\")\r\n+\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    line2, col2, ttype2, dtype = tokens[i]\r\n+\r\n+                    valid_types = [\"INT\", \"BIGINT\", \"NVARCHAR\", \"VARCHAR\", \"CHAR\",\r\n+                                 \"DATETIME\", \"DATE\", \"BIT\", \"FLOAT\", \"DECIMAL\",\r\n+                                 \"VARBINARY\", \"BINARY\", \"TINYINT\", \"SMALLINT\",\r\n+                                 \"MONEY\", \"SMALLMONEY\", \"REAL\", \"NUMERIC\"]\r\n+\r\n+                    dtype_clean = dtype.strip('[]').upper()\r\n+\r\n+                    if ttype2 in [\"KEYWORD\", \"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                        if dtype_clean not in valid_types and dtype.upper() not in valid_types:\r\n+                            self.add_error(line2, col2,\r\n+                                f\"Unknown data type '{dtype}'\", \"WARNING\")\r\n+\r\n+                    nullable = True\r\n+                    i += 1\r\n+                    while i < len(tokens) and tokens[i][2] == \"KEYWORD\":\r\n+                        if tokens[i][3].upper() == \"NOT\":\r\n+                            nullable = False\r\n+                        i += 1\r\n+\r\n+                    column = Column(col_name, dtype_clean, nullable)\r\n+                    table.add_column(column)\r\n+\r\n+            i += 1\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_alter_table(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+            i += 1\r\n+\r\n+        if i >= len(tokens):\r\n+            return i\r\n+\r\n+        line, col, ttype, table_name = tokens[i]\r\n+        raw_name = table_name.strip('[]')\r\n+\r\n+        schema = \"dbo\"\r\n+        if '.' in raw_name:\r\n+            parts = raw_name.split('.')\r\n+            schema = parts[0].upper()\r\n+            table_name_clean = parts[1].upper()\r\n+        else:\r\n+            table_name_clean = raw_name.upper()\r\n+\r\n+        if not self.symbol_table.has_table(table_name_clean, schema):\r\n+            table = Table(table_name_clean, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            self.add_error(\r\n+                line, col,\r\n+                f\"Table '{table_name_clean}' assumed to exist (ALTER without CREATE)\",\r\n+                \"WARNING\"\r\n+            )\r\n+\r\n+        i += 1\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"ADD\":\r\n+                i += 1\r\n+                if i < len(tokens) and tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                    col_line, col_col, col_type, col_name = tokens[i]\r\n+                    col_name_clean = col_name.strip('[]').upper()\r\n+\r\n+                    table = self.symbol_table.get_table(table_name_clean) or self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n+                    if table and table.has_column(col_name_clean):\r\n+                        self.add_error(col_line, col_col,\r\n+                            f\"Column '{col_name}' already exists in table '{table_name}'\",\r\n+                            \"WARNING\")\r\n+                    elif table:\r\n+                        i += 1\r\n+                        if i < len(tokens):\r\n+                            dtype = tokens[i][3]\r\n+                            column = Column(col_name_clean, dtype)\r\n+                            table.add_column(column)\r\n+            i += 1\r\n+            if i - 1 < len(tokens):\r\n+                token_text = tokens[i - 1][3]\r\n+                if token_text == ';' or token_text.upper() == \"GO\":\r\n+                    break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_update(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens):\r\n+            line, col, ttype, table_name = tokens[i]\r\n+            raw_name = table_name.strip('[]')\r\n+\r\n+            schema = \"dbo\"\r\n+            if '.' in raw_name:\r\n+                parts = raw_name.split('.')\r\n+                schema = parts[0].upper()\r\n+                table_name_clean = parts[1].upper()\r\n+            else:\r\n+                table_name_clean = raw_name.upper()\r\n+\r\n+        if not self.symbol_table.has_table(table_name_clean, schema):\r\n+            table = Table(table_name_clean, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            self.add_error(\r\n+                line, col,\r\n+                f\"Table '{table_name_clean}' assumed to exist (UPDATE without CREATE)\",\r\n+                \"WARNING\"\r\n+            )\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"SET\":\r\n+                i += 1\r\n+                while i < len(tokens):\r\n+                    if tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                        col_line, col_col, _, col_name = tokens[i]\r\n+                        col_name_clean = col_name.strip('[]').upper()\r\n+\r\n+                        table = (\r\n+                            self.symbol_table.get_table(table_name_clean) or\r\n+                            self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n+                        )\r\n+\r\n+                        if table and not table.has_column(col_name_clean):\r\n+                            self.add_error(\r\n+                                col_line, col_col,\r\n+                                f\"Column '{col_name}' does not exist in table '{table_name}'\",\r\n+                                \"ERROR\"\r\n+                            )\r\n+\r\n+                    if i < len(tokens):\r\n+                        token_text = tokens[i][3] if len(tokens[i]) > 3 else ''\r\n+                        if token_text in [';'] or token_text.upper() in ['WHERE', 'GO']:\r\n+                            break\r\n+\r\n+                    i += 1\r\n+                break\r\n+\r\n+            i += 1\r\n+            if i > 0 and i - 1 < len(tokens) and tokens[i - 1][3] in [';', 'GO']:\r\n+                break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    line, col, ttype, table_name = tokens[i]\r\n+\r\n+                    schema = \"DBO\"\r\n+                    table_name_clean = \"\"\r\n+\r\n+                    if i + 2 < len(tokens) and tokens[i + 1][3] == '.':\r\n+                        schema = tokens[i][3].strip('[]').upper()\r\n+                        table_name_clean = tokens[i + 2][3].strip('[]').upper()\r\n+                        i += 2\r\n+                    else:\r\n+                        table_name_clean = tokens[i][3].strip('[]').upper()\r\n+\r\n+                    if schema.upper() in [\"SYS\", \"INFORMATION_SCHEMA\"]:\r\n+                        i += 1\r\n+                        continue\r\n+\r\n+                    if table_name_clean in [\"COLUMNS\", \"FOREIGN_KEYS\", \"TABLES\", \"OBJECTS\"]:\r\n+                        i += 1\r\n+                        continue\r\n+\r\n+                    if (not self.symbol_table.has_table(table_name_clean, schema) and\r\n+                        not self.symbol_table.has_table(table_name_clean, \"DBO\")):\r\n+                        self.add_error(line, col,\r\n+                            f\"Table '{schema}.{table_name_clean}' does not exist\", \"WARNING\")\r\n+\r\n+            i += 1\r\n+            if i > 0 and tokens[i - 1][3] in [';', ')']:\r\n+                break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_declare(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n+            line, col, ttype, var_name = tokens[i]\r\n+\r\n+            if self.symbol_table.has_variable(var_name):\r\n+                self.add_error(line, col,\r\n+                    f\"Variable '{var_name}' already declared\", \"WARNING\")\r\n+            else:\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    dtype = tokens[i][3]\r\n+                    self.symbol_table.add_variable(Variable(var_name, dtype))\r\n+\r\n+        return i + 1\r\n+\r\n+    def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n+            line, col, ttype, var_name = tokens[i]\r\n+\r\n+            if not self.symbol_table.has_variable(var_name):\r\n+                self.add_error(line, col,\r\n+                    f\"Variable '{var_name}' not declared\", \"ERROR\")\r\n+            else:\r\n+                variable = self.symbol_table.get_variable(var_name)\r\n+                variable.initialized = True\r\n+\r\n+        return i + 1\r\n+\r\n+    def generate_report(self) -> str:\r\n+        report = []\r\n+        report.append(\"=\" * 80)\r\n+        report.append(\"SEMANTIC ANALYSIS REPORT\".center(80))\r\n+        report.append(\"=\" * 80)\r\n+        report.append(\"\")\r\n+\r\n+        if self.stats['total_literals'] > 0:\r\n+            report.append(\"Literal Statistics:\")\r\n+            report.append(f\"  • Total Literals: {self.stats['total_literals']}\")\r\n+            report.append(f\"  • Regular Strings: {self.stats['regular_strings']}\")\r\n+            report.append(f\"  • Hex Strings: {self.stats['hex_strings']}\")\r\n+            report.append(f\"  • Bit Strings: {self.stats['bit_strings']}\")\r\n+            report.append(f\"  • Numbers: {self.stats['numbers']}\")\r\n+            report.append(\"\")\r\n+\r\n+        report.append(f\"Tables Defined: {len(self.symbol_table.tables)}\")\r\n+        for table_name, table in self.symbol_table.tables.items():\r\n+            if not table_name.startswith(\"SYS.\") and not table_name.startswith(\"INFORMATION_SCHEMA.\"):\r\n+                report.append(f\"  • {table.schema}.{table.name} ({len(table.columns)} columns)\")\r\n+                for col_name, col in table.columns.items():\r\n+                    null_str = \"NULL\" if col.nullable else \"NOT NULL\"\r\n+                    report.append(f\"      - {col.name}: {col.data_type} {null_str}\")\r\n+        report.append(\"\")\r\n+\r\n+        report.append(f\"Variables Declared: {len(self.symbol_table.variables)}\")\r\n+        for var in self.symbol_table.variables.values():\r\n+            init_str = \"initialized\" if var.initialized else \"not initialized\"\r\n+            report.append(f\"  • {var.name}: {var.data_type} ({init_str})\")\r\n+        report.append(\"\")\r\n+\r\n+        if self.errors:\r\n+            report.append(f\"ERRORS: {len(self.errors)}\")\r\n+            for error in self.errors:\r\n+                report.append(f\"  ✗ {error}\")\r\n+            report.append(\"\")\r\n+\r\n+        if self.warnings:\r\n+            report.append(f\"WARNINGS: {len(self.warnings)}\")\r\n+            for warning in self.warnings:\r\n+                report.append(f\"   {warning}\")\r\n+            report.append(\"\")\r\n+\r\n+        if not self.errors:\r\n+            report.append(\"✓ No semantic errors found!\")\r\n+\r\n+        report.append(\"=\" * 80)\r\n+\r\n+        return \"\\n\".join(report)\n\\ No newline at end of file\n"
                },
                {
                    "date": 1768913417271,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,435 @@\n+from typing import List, Tuple\r\n+from dataclasses import dataclass\r\n+from .symbol_table import SymbolTable, Table, Column, Variable\r\n+\r\n+\r\n+@dataclass\r\n+class SemanticError:\r\n+    line: int\r\n+    column: int\r\n+    message: str\r\n+    severity: str = \"ERROR\"\r\n+\r\n+    def __str__(self):\r\n+        return f\"[{self.severity}] Line {self.line}, Col {self.column}: {self.message}\"\r\n+\r\n+\r\n+class SemanticAnalyzer:\r\n+\r\n+    def __init__(self):\r\n+        self.symbol_table = SymbolTable()\r\n+        self.errors: List[SemanticError] = []\r\n+        self.warnings: List[SemanticError] = []\r\n+\r\n+        self.stats = {\r\n+            'hex_strings': 0,\r\n+            'bit_strings': 0,\r\n+            'regular_strings': 0,\r\n+            'numbers': 0,\r\n+            'total_literals': 0\r\n+        }\r\n+\r\n+    def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n+        error = SemanticError(line, column, message, severity)\r\n+        if severity == \"ERROR\":\r\n+            self.errors.append(error)\r\n+        elif severity == \"WARNING\":\r\n+            self.warnings.append(error)\r\n+\r\n+    def analyze_tokens(self, tokens: List[Tuple]):\r\n+        i = 0\r\n+        while i < len(tokens):\r\n+            line, col, ttype, text = tokens[i]\r\n+\r\n+            if ttype == \"HEX_STRING\":\r\n+                self.stats['hex_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+                self._validate_hex_string(line, col, text)\r\n+\r\n+            elif ttype == \"BIT_STRING\":\r\n+                self.stats['bit_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+                self._validate_bit_string(line, col, text)\r\n+\r\n+            elif ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n+                self.stats['regular_strings'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+\r\n+            elif ttype == \"NUMBER\":\r\n+                self.stats['numbers'] += 1\r\n+                self.stats['total_literals'] += 1\r\n+\r\n+            if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n+                i = self._analyze_create_table(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n+                i = self._analyze_alter_table(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"UPDATE\":\r\n+                i = self._analyze_update(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"SELECT\":\r\n+                i = self._analyze_select(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"DECLARE\":\r\n+                i = self._analyze_declare(tokens, i)\r\n+\r\n+            elif ttype == \"KEYWORD\" and text.upper() == \"SET\":\r\n+                i = self._analyze_set(tokens, i)\r\n+\r\n+            i += 1\r\n+\r\n+        return self.errors, self.warnings\r\n+\r\n+    def _validate_hex_string(self, line: int, col: int, text: str):\r\n+        hex_part = text[2:].replace('\\\\', '').replace(\r\n+            '\\n', '').replace('\\r', '')\r\n+\r\n+        valid_hex = set('0123456789abcdefABCDEF')\r\n+        invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n+\r\n+        if invalid_chars:\r\n+            self.add_error(line, col,\r\n+                           f\"Invalid characters in hex string: {set(invalid_chars)}\",\r\n+                           \"ERROR\")\r\n+\r\n+        if len(hex_part) % 2 != 0:\r\n+            self.add_error(line, col,\r\n+                           f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n+                           \"WARNING\")\r\n+\r\n+    def _validate_bit_string(self, line: int, col: int, text: str):\r\n+        bit_part = text[2:].replace('\\\\', '').replace(\r\n+            '\\n', '').replace('\\r', '')\r\n+\r\n+        invalid_chars = [c for c in bit_part if c not in '01']\r\n+\r\n+        if invalid_chars:\r\n+            self.add_error(line, col,\r\n+                           f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n+                           \"ERROR\")\r\n+\r\n+    def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+            i += 1\r\n+\r\n+        if i >= len(tokens):\r\n+            return i\r\n+\r\n+        line, col, ttype, first = tokens[i]\r\n+\r\n+        schema = \"dbo\"\r\n+        table_name = first.strip('[]')\r\n+\r\n+        if i + 2 < len(tokens):\r\n+            if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                schema = table_name.upper()\r\n+                table_name = tokens[i + 2][3].strip('[]')\r\n+                i += 2\r\n+\r\n+        schema = schema.upper()\r\n+        table_name = table_name.upper()\r\n+\r\n+        full_table_name = f\"{schema.upper()}.{table_name.upper()}\"\r\n+\r\n+        if self.symbol_table.has_table(table_name, schema):\r\n+            self.add_error(line, col,\r\n+                           f\"Table '{table_name}' already exists\", \"WARNING\")\r\n+        else:\r\n+            table = Table(table_name, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            i = self._parse_columns(tokens, i + 1, table)\r\n+\r\n+        return i\r\n+\r\n+    def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n+        i = start\r\n+\r\n+        while i < len(tokens):\r\n+            line, col, ttype, text = tokens[i]\r\n+\r\n+            if text == ')':\r\n+                break\r\n+\r\n+            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                col_name = text.strip('[]')\r\n+\r\n+                if \"'\" in col_name:\r\n+                    self.add_error(line, col,\r\n+                                   f\"Column name '{col_name}' contains apostrophe - consider using bracket notation\",\r\n+                                   \"WARNING\")\r\n+\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    line2, col2, ttype2, dtype = tokens[i]\r\n+\r\n+                    valid_types = [\"INT\", \"BIGINT\", \"NVARCHAR\", \"VARCHAR\", \"CHAR\",\r\n+                                   \"DATETIME\", \"DATE\", \"BIT\", \"FLOAT\", \"DECIMAL\",\r\n+                                   \"VARBINARY\", \"BINARY\", \"TINYINT\", \"SMALLINT\",\r\n+                                   \"MONEY\", \"SMALLMONEY\", \"REAL\", \"NUMERIC\"]\r\n+\r\n+                    dtype_clean = dtype.strip('[]').upper()\r\n+\r\n+                    if ttype2 in [\"KEYWORD\", \"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                        if dtype_clean not in valid_types and dtype.upper() not in valid_types:\r\n+                            self.add_error(line2, col2,\r\n+                                           f\"Unknown data type '{dtype}'\", \"WARNING\")\r\n+\r\n+                    nullable = True\r\n+                    i += 1\r\n+                    while i < len(tokens) and tokens[i][2] == \"KEYWORD\":\r\n+                        if tokens[i][3].upper() == \"NOT\":\r\n+                            nullable = False\r\n+                        i += 1\r\n+\r\n+                    column = Column(col_name, dtype_clean, nullable)\r\n+                    table.add_column(column)\r\n+\r\n+            i += 1\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_alter_table(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+            i += 1\r\n+\r\n+        if i >= len(tokens):\r\n+            return i\r\n+\r\n+        line, col, ttype, table_name = tokens[i]\r\n+        raw_name = table_name.strip('[]')\r\n+\r\n+        schema = \"dbo\"\r\n+        if '.' in raw_name:\r\n+            parts = raw_name.split('.')\r\n+            schema = parts[0].upper()\r\n+            table_name_clean = parts[1].upper()\r\n+        else:\r\n+            table_name_clean = raw_name.upper()\r\n+\r\n+        if not self.symbol_table.has_table(table_name_clean, schema):\r\n+            table = Table(table_name_clean, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            self.add_error(\r\n+                line, col,\r\n+                f\"Table '{table_name_clean}' assumed to exist (ALTER without CREATE)\",\r\n+                \"WARNING\"\r\n+            )\r\n+\r\n+        i += 1\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"ADD\":\r\n+                i += 1\r\n+                if i < len(tokens) and tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                    col_line, col_col, col_type, col_name = tokens[i]\r\n+                    col_name_clean = col_name.strip('[]').upper()\r\n+\r\n+                    table = self.symbol_table.get_table(\r\n+                        table_name_clean) or self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n+                    if table and table.has_column(col_name_clean):\r\n+                        self.add_error(col_line, col_col,\r\n+                                       f\"Column '{col_name}' already exists in table '{table_name}'\",\r\n+                                       \"WARNING\")\r\n+                    elif table:\r\n+                        i += 1\r\n+                        if i < len(tokens):\r\n+                            dtype = tokens[i][3]\r\n+                            column = Column(col_name_clean, dtype)\r\n+                            table.add_column(column)\r\n+            i += 1\r\n+            if i - 1 < len(tokens):\r\n+                token_text = tokens[i - 1][3]\r\n+                if token_text == ';' or token_text.upper() == \"GO\":\r\n+                    break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_update(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens):\r\n+            line, col, ttype, table_name = tokens[i]\r\n+            raw_name = table_name.strip('[]')\r\n+\r\n+            schema = \"dbo\"\r\n+            if '.' in raw_name:\r\n+                parts = raw_name.split('.')\r\n+                schema = parts[0].upper()\r\n+                table_name_clean = parts[1].upper()\r\n+            else:\r\n+                table_name_clean = raw_name.upper()\r\n+\r\n+        if not self.symbol_table.has_table(table_name_clean, schema):\r\n+            table = Table(table_name_clean, schema)\r\n+            self.symbol_table.add_table(table)\r\n+\r\n+            self.add_error(\r\n+                line, col,\r\n+                f\"Table '{table_name_clean}' assumed to exist (UPDATE without CREATE)\",\r\n+                \"WARNING\"\r\n+            )\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"SET\":\r\n+                i += 1\r\n+                while i < len(tokens):\r\n+                    if tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n+                        col_line, col_col, _, col_name = tokens[i]\r\n+                        col_name_clean = col_name.strip('[]').upper()\r\n+\r\n+                        table = (\r\n+                            self.symbol_table.get_table(table_name_clean) or\r\n+                            self.symbol_table.get_table(\r\n+                                table_name_clean, \"DBO\")\r\n+                        )\r\n+\r\n+                        if table and not table.has_column(col_name_clean):\r\n+                            self.add_error(\r\n+                                col_line, col_col,\r\n+                                f\"Column '{col_name}' does not exist in table '{table_name}'\",\r\n+                                \"ERROR\"\r\n+                            )\r\n+\r\n+                    if i < len(tokens):\r\n+                        token_text = tokens[i][3] if len(tokens[i]) > 3 else ''\r\n+                        if token_text in [';'] or token_text.upper() in ['WHERE', 'GO']:\r\n+                            break\r\n+\r\n+                    i += 1\r\n+                break\r\n+\r\n+            i += 1\r\n+            if i > 0 and i - 1 < len(tokens) and tokens[i - 1][3] in [';', 'GO']:\r\n+                break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        while i < len(tokens):\r\n+            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    line, col, ttype, table_name = tokens[i]\r\n+\r\n+                    schema = \"DBO\"\r\n+                    table_name_clean = \"\"\r\n+\r\n+                    if i + 2 < len(tokens) and tokens[i + 1][3] == '.':\r\n+                        schema = tokens[i][3].strip('[]').upper()\r\n+                        table_name_clean = tokens[i + 2][3].strip('[]').upper()\r\n+                        i += 2\r\n+                    else:\r\n+                        table_name_clean = tokens[i][3].strip('[]').upper()\r\n+\r\n+                    if schema.upper() in [\"SYS\", \"INFORMATION_SCHEMA\"]:\r\n+                        i += 1\r\n+                        continue\r\n+\r\n+                    if table_name_clean in [\"COLUMNS\", \"FOREIGN_KEYS\", \"TABLES\", \"OBJECTS\"]:\r\n+                        i += 1\r\n+                        continue\r\n+\r\n+                    if (not self.symbol_table.has_table(table_name_clean, schema) and\r\n+                            not self.symbol_table.has_table(table_name_clean, \"DBO\")):\r\n+                        self.add_error(line, col,\r\n+                                       f\"Table '{schema}.{table_name_clean}' does not exist\", \"WARNING\")\r\n+\r\n+            i += 1\r\n+            if i > 0 and tokens[i - 1][3] in [';', ')']:\r\n+                break\r\n+\r\n+        return i\r\n+\r\n+    def _analyze_declare(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n+            line, col, ttype, var_name = tokens[i]\r\n+\r\n+            if self.symbol_table.has_variable(var_name):\r\n+                self.add_error(line, col,\r\n+                               f\"Variable '{var_name}' already declared\", \"WARNING\")\r\n+            else:\r\n+                i += 1\r\n+                if i < len(tokens):\r\n+                    dtype = tokens[i][3]\r\n+                    self.symbol_table.add_variable(Variable(var_name, dtype))\r\n+\r\n+        return i + 1\r\n+\r\n+    def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n+        i = start + 1\r\n+\r\n+        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n+            line, col, ttype, var_name = tokens[i]\r\n+\r\n+            if not self.symbol_table.has_variable(var_name):\r\n+                self.add_error(line, col,\r\n+                               f\"Variable '{var_name}' not declared\", \"ERROR\")\r\n+            else:\r\n+                variable = self.symbol_table.get_variable(var_name)\r\n+                variable.initialized = True\r\n+\r\n+        return i + 1\r\n+\r\n+    def generate_report(self) -> str:\r\n+        report = []\r\n+        report.append(\"=\" * 80)\r\n+        report.append(\"SEMANTIC ANALYSIS REPORT\".center(80))\r\n+        report.append(\"=\" * 80)\r\n+        report.append(\"\")\r\n+\r\n+        if self.stats['total_literals'] > 0:\r\n+            report.append(\"Literal Statistics:\")\r\n+            report.append(\r\n+                f\"  • Total Literals: {self.stats['total_literals']}\")\r\n+            report.append(\r\n+                f\"  • Regular Strings: {self.stats['regular_strings']}\")\r\n+            report.append(f\"  • Hex Strings: {self.stats['hex_strings']}\")\r\n+            report.append(f\"  • Bit Strings: {self.stats['bit_strings']}\")\r\n+            report.append(f\"  • Numbers: {self.stats['numbers']}\")\r\n+            report.append(\"\")\r\n+\r\n+        report.append(f\"Tables Defined: {len(self.symbol_table.tables)}\")\r\n+        for table_name, table in self.symbol_table.tables.items():\r\n+            if not table_name.startswith(\"SYS.\") and not table_name.startswith(\"INFORMATION_SCHEMA.\"):\r\n+                report.append(\r\n+                    f\"  • {table.schema}.{table.name} ({len(table.columns)} columns)\")\r\n+                for col_name, col in table.columns.items():\r\n+                    null_str = \"NULL\" if col.nullable else \"NOT NULL\"\r\n+                    report.append(\r\n+                        f\"      - {col.name}: {col.data_type} {null_str}\")\r\n+        report.append(\"\")\r\n+\r\n+        report.append(\r\n+            f\"Variables Declared: {len(self.symbol_table.variables)}\")\r\n+        for var in self.symbol_table.variables.values():\r\n+            init_str = \"initialized\" if var.initialized else \"not initialized\"\r\n+            report.append(f\"  • {var.name}: {var.data_type} ({init_str})\")\r\n+        report.append(\"\")\r\n+\r\n+        if self.errors:\r\n+            report.append(f\"ERRORS: {len(self.errors)}\")\r\n+            for error in self.errors:\r\n+                report.append(f\"   {error}\")\r\n+            report.append(\"\")\r\n+\r\n+        if self.warnings:\r\n+            report.append(f\"WARNINGS: {len(self.warnings)}\")\r\n+            for warning in self.warnings:\r\n+                report.append(f\"   {warning}\")\r\n+            report.append(\"\")\r\n+\r\n+        if not self.errors:\r\n+            report.append(\"✓ No semantic errors found!\")\r\n+\r\n+        report.append(\"=\" * 80)\r\n+\r\n+        return \"\\n\".join(report)\r\n"
                },
                {
                    "date": 1769065645921,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -427,868 +427,9 @@\n                 report.append(f\"   {warning}\")\r\n             report.append(\"\")\r\n \r\n         if not self.errors:\r\n-            report.append(\"✓ No semantic errors found!\")\r\n+            report.append(\"No semantic errors found!\")\r\n \r\n         report.append(\"=\" * 80)\r\n \r\n         return \"\\n\".join(report)\r\n-from typing import List, Tuple\r\n-from dataclasses import dataclass\r\n-from .symbol_table import SymbolTable, Table, Column, Variable\r\n-\r\n-\r\n-@dataclass\r\n-class SemanticError:\r\n-    line: int\r\n-    column: int\r\n-    message: str\r\n-    severity: str = \"ERROR\"\r\n-\r\n-    def __str__(self):\r\n-        return f\"[{self.severity}] Line {self.line}, Col {self.column}: {self.message}\"\r\n-\r\n-\r\n-class SemanticAnalyzer:\r\n-\r\n-    def __init__(self):\r\n-        self.symbol_table = SymbolTable()\r\n-        self.errors: List[SemanticError] = []\r\n-        self.warnings: List[SemanticError] = []\r\n-\r\n-        self.stats = {\r\n-            'hex_strings': 0,\r\n-            'bit_strings': 0,\r\n-            'regular_strings': 0,\r\n-            'numbers': 0,\r\n-            'total_literals': 0\r\n-        }\r\n-\r\n-    def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n-        error = SemanticError(line, column, message, severity)\r\n-        if severity == \"ERROR\":\r\n-            self.errors.append(error)\r\n-        elif severity == \"WARNING\":\r\n-            self.warnings.append(error)\r\n-\r\n-    def analyze_tokens(self, tokens: List[Tuple]):\r\n-        i = 0\r\n-        while i < len(tokens):\r\n-            line, col, ttype, text = tokens[i]\r\n-\r\n-            if ttype == \"HEX_STRING\":\r\n-                self.stats['hex_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-                self._validate_hex_string(line, col, text)\r\n-\r\n-            elif ttype == \"BIT_STRING\":\r\n-                self.stats['bit_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-                self._validate_bit_string(line, col, text)\r\n-\r\n-            elif ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n-                self.stats['regular_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-\r\n-            elif ttype == \"NUMBER\":\r\n-                self.stats['numbers'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-\r\n-            if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n-                i = self._analyze_create_table(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n-                i = self._analyze_alter_table(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"UPDATE\":\r\n-                i = self._analyze_update(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"SELECT\":\r\n-                i = self._analyze_select(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"DECLARE\":\r\n-                i = self._analyze_declare(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"SET\":\r\n-                i = self._analyze_set(tokens, i)\r\n-\r\n-            i += 1\r\n-\r\n-        return self.errors, self.warnings\r\n-\r\n-    def _validate_hex_string(self, line: int, col: int, text: str):\r\n-        hex_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n-\r\n-        valid_hex = set('0123456789abcdefABCDEF')\r\n-        invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n-\r\n-        if invalid_chars:\r\n-            self.add_error(line, col,\r\n-                f\"Invalid characters in hex string: {set(invalid_chars)}\",\r\n-                \"ERROR\")\r\n-\r\n-        if len(hex_part) % 2 != 0:\r\n-            self.add_error(line, col,\r\n-                f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n-                \"WARNING\")\r\n-\r\n-    def _validate_bit_string(self, line: int, col: int, text: str):\r\n-        bit_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n-\r\n-        invalid_chars = [c for c in bit_part if c not in '01']\r\n-\r\n-        if invalid_chars:\r\n-            self.add_error(line, col,\r\n-                f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n-                \"ERROR\")\r\n-\r\n-    def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-            i += 1\r\n-\r\n-        if i >= len(tokens):\r\n-            return i\r\n-\r\n-        line, col, ttype, first = tokens[i]\r\n-\r\n-        schema = \"dbo\"\r\n-        table_name = first.strip('[]')\r\n-\r\n-        if i + 2 < len(tokens):\r\n-            if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                schema = table_name.upper()\r\n-                table_name = tokens[i + 2][3].strip('[]')\r\n-                i += 2\r\n-\r\n-        schema = schema.upper()\r\n-        table_name = table_name.upper()\r\n-\r\n-        full_table_name = f\"{schema.upper()}.{table_name.upper()}\"\r\n-\r\n-        if self.symbol_table.has_table(table_name, schema):\r\n-            self.add_error(line, col,\r\n-                f\"Table '{table_name}' already exists\", \"WARNING\")\r\n-        else:\r\n-            table = Table(table_name, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            i = self._parse_columns(tokens, i + 1, table)\r\n-\r\n-        return i\r\n-\r\n-    def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n-        i = start\r\n-\r\n-        while i < len(tokens):\r\n-            line, col, ttype, text = tokens[i]\r\n-\r\n-            if text == ')':\r\n-                break\r\n-\r\n-            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                col_name = text.strip('[]')\r\n-\r\n-                if \"'\" in col_name:\r\n-                    self.add_error(line, col,\r\n-                        f\"Column name '{col_name}' contains apostrophe - consider using bracket notation\",\r\n-                        \"WARNING\")\r\n-\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    line2, col2, ttype2, dtype = tokens[i]\r\n-\r\n-                    valid_types = [\"INT\", \"BIGINT\", \"NVARCHAR\", \"VARCHAR\", \"CHAR\",\r\n-                                 \"DATETIME\", \"DATE\", \"BIT\", \"FLOAT\", \"DECIMAL\",\r\n-                                 \"VARBINARY\", \"BINARY\", \"TINYINT\", \"SMALLINT\",\r\n-                                 \"MONEY\", \"SMALLMONEY\", \"REAL\", \"NUMERIC\"]\r\n-\r\n-                    dtype_clean = dtype.strip('[]').upper()\r\n-\r\n-                    if ttype2 in [\"KEYWORD\", \"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                        if dtype_clean not in valid_types and dtype.upper() not in valid_types:\r\n-                            self.add_error(line2, col2,\r\n-                                f\"Unknown data type '{dtype}'\", \"WARNING\")\r\n-\r\n-                    nullable = True\r\n-                    i += 1\r\n-                    while i < len(tokens) and tokens[i][2] == \"KEYWORD\":\r\n-                        if tokens[i][3].upper() == \"NOT\":\r\n-                            nullable = False\r\n-                        i += 1\r\n-\r\n-                    column = Column(col_name, dtype_clean, nullable)\r\n-                    table.add_column(column)\r\n-\r\n-            i += 1\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_alter_table(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-            i += 1\r\n-\r\n-        if i >= len(tokens):\r\n-            return i\r\n-\r\n-        line, col, ttype, table_name = tokens[i]\r\n-        raw_name = table_name.strip('[]')\r\n-\r\n-        schema = \"dbo\"\r\n-        if '.' in raw_name:\r\n-            parts = raw_name.split('.')\r\n-            schema = parts[0].upper()\r\n-            table_name_clean = parts[1].upper()\r\n-        else:\r\n-            table_name_clean = raw_name.upper()\r\n-\r\n-        if not self.symbol_table.has_table(table_name_clean, schema):\r\n-            table = Table(table_name_clean, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            self.add_error(\r\n-                line, col,\r\n-                f\"Table '{table_name_clean}' assumed to exist (ALTER without CREATE)\",\r\n-                \"WARNING\"\r\n-            )\r\n-\r\n-        i += 1\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"ADD\":\r\n-                i += 1\r\n-                if i < len(tokens) and tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                    col_line, col_col, col_type, col_name = tokens[i]\r\n-                    col_name_clean = col_name.strip('[]').upper()\r\n-\r\n-                    table = self.symbol_table.get_table(table_name_clean) or self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n-                    if table and table.has_column(col_name_clean):\r\n-                        self.add_error(col_line, col_col,\r\n-                            f\"Column '{col_name}' already exists in table '{table_name}'\",\r\n-                            \"WARNING\")\r\n-                    elif table:\r\n-                        i += 1\r\n-                        if i < len(tokens):\r\n-                            dtype = tokens[i][3]\r\n-                            column = Column(col_name_clean, dtype)\r\n-                            table.add_column(column)\r\n-            i += 1\r\n-            if i - 1 < len(tokens):\r\n-                token_text = tokens[i - 1][3]\r\n-                if token_text == ';' or token_text.upper() == \"GO\":\r\n-                    break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_update(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens):\r\n-            line, col, ttype, table_name = tokens[i]\r\n-            raw_name = table_name.strip('[]')\r\n-\r\n-            schema = \"dbo\"\r\n-            if '.' in raw_name:\r\n-                parts = raw_name.split('.')\r\n-                schema = parts[0].upper()\r\n-                table_name_clean = parts[1].upper()\r\n-            else:\r\n-                table_name_clean = raw_name.upper()\r\n-\r\n-        if not self.symbol_table.has_table(table_name_clean, schema):\r\n-            table = Table(table_name_clean, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            self.add_error(\r\n-                line, col,\r\n-                f\"Table '{table_name_clean}' assumed to exist (UPDATE without CREATE)\",\r\n-                \"WARNING\"\r\n-            )\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"SET\":\r\n-                i += 1\r\n-                while i < len(tokens):\r\n-                    if tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                        col_line, col_col, _, col_name = tokens[i]\r\n-                        col_name_clean = col_name.strip('[]').upper()\r\n-\r\n-                        table = (\r\n-                            self.symbol_table.get_table(table_name_clean) or\r\n-                            self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n-                        )\r\n-\r\n-                        if table and not table.has_column(col_name_clean):\r\n-                            self.add_error(\r\n-                                col_line, col_col,\r\n-                                f\"Column '{col_name}' does not exist in table '{table_name}'\",\r\n-                                \"ERROR\"\r\n-                            )\r\n-\r\n-                    if i < len(tokens):\r\n-                        token_text = tokens[i][3] if len(tokens[i]) > 3 else ''\r\n-                        if token_text in [';'] or token_text.upper() in ['WHERE', 'GO']:\r\n-                            break\r\n-\r\n-                    i += 1\r\n-                break\r\n-\r\n-            i += 1\r\n-            if i > 0 and i - 1 < len(tokens) and tokens[i - 1][3] in [';', 'GO']:\r\n-                break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    line, col, ttype, table_name = tokens[i]\r\n-\r\n-                    schema = \"DBO\"\r\n-                    table_name_clean = \"\"\r\n-\r\n-                    if i + 2 < len(tokens) and tokens[i + 1][3] == '.':\r\n-                        schema = tokens[i][3].strip('[]').upper()\r\n-                        table_name_clean = tokens[i + 2][3].strip('[]').upper()\r\n-                        i += 2\r\n-                    else:\r\n-                        table_name_clean = tokens[i][3].strip('[]').upper()\r\n-\r\n-                    if schema.upper() in [\"SYS\", \"INFORMATION_SCHEMA\"]:\r\n-                        i += 1\r\n-                        continue\r\n-\r\n-                    if table_name_clean in [\"COLUMNS\", \"FOREIGN_KEYS\", \"TABLES\", \"OBJECTS\"]:\r\n-                        i += 1\r\n-                        continue\r\n-\r\n-                    if (not self.symbol_table.has_table(table_name_clean, schema) and\r\n-                        not self.symbol_table.has_table(table_name_clean, \"DBO\")):\r\n-                        self.add_error(line, col,\r\n-                            f\"Table '{schema}.{table_name_clean}' does not exist\", \"WARNING\")\r\n-\r\n-            i += 1\r\n-            if i > 0 and tokens[i - 1][3] in [';', ')']:\r\n-                break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_declare(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n-            line, col, ttype, var_name = tokens[i]\r\n-\r\n-            if self.symbol_table.has_variable(var_name):\r\n-                self.add_error(line, col,\r\n-                    f\"Variable '{var_name}' already declared\", \"WARNING\")\r\n-            else:\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    dtype = tokens[i][3]\r\n-                    self.symbol_table.add_variable(Variable(var_name, dtype))\r\n-\r\n-        return i + 1\r\n-\r\n-    def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n-            line, col, ttype, var_name = tokens[i]\r\n-\r\n-            if not self.symbol_table.has_variable(var_name):\r\n-                self.add_error(line, col,\r\n-                    f\"Variable '{var_name}' not declared\", \"ERROR\")\r\n-            else:\r\n-                variable = self.symbol_table.get_variable(var_name)\r\n-                variable.initialized = True\r\n-\r\n-        return i + 1\r\n-\r\n-    def generate_report(self) -> str:\r\n-        report = []\r\n-        report.append(\"=\" * 80)\r\n-        report.append(\"SEMANTIC ANALYSIS REPORT\".center(80))\r\n-        report.append(\"=\" * 80)\r\n-        report.append(\"\")\r\n-\r\n-        if self.stats['total_literals'] > 0:\r\n-            report.append(\"Literal Statistics:\")\r\n-            report.append(f\"  • Total Literals: {self.stats['total_literals']}\")\r\n-            report.append(f\"  • Regular Strings: {self.stats['regular_strings']}\")\r\n-            report.append(f\"  • Hex Strings: {self.stats['hex_strings']}\")\r\n-            report.append(f\"  • Bit Strings: {self.stats['bit_strings']}\")\r\n-            report.append(f\"  • Numbers: {self.stats['numbers']}\")\r\n-            report.append(\"\")\r\n-\r\n-        report.append(f\"Tables Defined: {len(self.symbol_table.tables)}\")\r\n-        for table_name, table in self.symbol_table.tables.items():\r\n-            if not table_name.startswith(\"SYS.\") and not table_name.startswith(\"INFORMATION_SCHEMA.\"):\r\n-                report.append(f\"  • {table.schema}.{table.name} ({len(table.columns)} columns)\")\r\n-                for col_name, col in table.columns.items():\r\n-                    null_str = \"NULL\" if col.nullable else \"NOT NULL\"\r\n-                    report.append(f\"      - {col.name}: {col.data_type} {null_str}\")\r\n-        report.append(\"\")\r\n-\r\n-        report.append(f\"Variables Declared: {len(self.symbol_table.variables)}\")\r\n-        for var in self.symbol_table.variables.values():\r\n-            init_str = \"initialized\" if var.initialized else \"not initialized\"\r\n-            report.append(f\"  • {var.name}: {var.data_type} ({init_str})\")\r\n-        report.append(\"\")\r\n-\r\n-        if self.errors:\r\n-            report.append(f\"ERRORS: {len(self.errors)}\")\r\n-            for error in self.errors:\r\n-                report.append(f\"  ✗ {error}\")\r\n-            report.append(\"\")\r\n-\r\n-        if self.warnings:\r\n-            report.append(f\"WARNINGS: {len(self.warnings)}\")\r\n-            for warning in self.warnings:\r\n-                report.append(f\"   {warning}\")\r\n-            report.append(\"\")\r\n-\r\n-        if not self.errors:\r\n-            report.append(\"✓ No semantic errors found!\")\r\n-\r\n-        report.append(\"=\" * 80)\r\n-\r\n-        return \"\\n\".join(report)\n-from typing import List, Tuple\r\n-from dataclasses import dataclass\r\n-from .symbol_table import SymbolTable, Table, Column, Variable\r\n-\r\n-\r\n-@dataclass\r\n-class SemanticError:\r\n-    line: int\r\n-    column: int\r\n-    message: str\r\n-    severity: str = \"ERROR\"\r\n-\r\n-    def __str__(self):\r\n-        return f\"[{self.severity}] Line {self.line}, Col {self.column}: {self.message}\"\r\n-\r\n-\r\n-class SemanticAnalyzer:\r\n-\r\n-    def __init__(self):\r\n-        self.symbol_table = SymbolTable()\r\n-        self.errors: List[SemanticError] = []\r\n-        self.warnings: List[SemanticError] = []\r\n-\r\n-        self.stats = {\r\n-            'hex_strings': 0,\r\n-            'bit_strings': 0,\r\n-            'regular_strings': 0,\r\n-            'numbers': 0,\r\n-            'total_literals': 0\r\n-        }\r\n-\r\n-    def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n-        error = SemanticError(line, column, message, severity)\r\n-        if severity == \"ERROR\":\r\n-            self.errors.append(error)\r\n-        elif severity == \"WARNING\":\r\n-            self.warnings.append(error)\r\n-\r\n-    def analyze_tokens(self, tokens: List[Tuple]):\r\n-        i = 0\r\n-        while i < len(tokens):\r\n-            line, col, ttype, text = tokens[i]\r\n-\r\n-            if ttype == \"HEX_STRING\":\r\n-                self.stats['hex_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-                self._validate_hex_string(line, col, text)\r\n-\r\n-            elif ttype == \"BIT_STRING\":\r\n-                self.stats['bit_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-                self._validate_bit_string(line, col, text)\r\n-\r\n-            elif ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n-                self.stats['regular_strings'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-\r\n-            elif ttype == \"NUMBER\":\r\n-                self.stats['numbers'] += 1\r\n-                self.stats['total_literals'] += 1\r\n-\r\n-            if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n-                i = self._analyze_create_table(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n-                i = self._analyze_alter_table(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"UPDATE\":\r\n-                i = self._analyze_update(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"SELECT\":\r\n-                i = self._analyze_select(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"DECLARE\":\r\n-                i = self._analyze_declare(tokens, i)\r\n-\r\n-            elif ttype == \"KEYWORD\" and text.upper() == \"SET\":\r\n-                i = self._analyze_set(tokens, i)\r\n-\r\n-            i += 1\r\n-\r\n-        return self.errors, self.warnings\r\n-\r\n-    def _validate_hex_string(self, line: int, col: int, text: str):\r\n-        hex_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n-\r\n-        valid_hex = set('0123456789abcdefABCDEF')\r\n-        invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n-\r\n-        if invalid_chars:\r\n-            self.add_error(line, col,\r\n-                f\"Invalid characters in hex string: {set(invalid_chars)}\",\r\n-                \"ERROR\")\r\n-\r\n-        if len(hex_part) % 2 != 0:\r\n-            self.add_error(line, col,\r\n-                f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n-                \"WARNING\")\r\n-\r\n-    def _validate_bit_string(self, line: int, col: int, text: str):\r\n-        bit_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n-\r\n-        invalid_chars = [c for c in bit_part if c not in '01']\r\n-\r\n-        if invalid_chars:\r\n-            self.add_error(line, col,\r\n-                f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n-                \"ERROR\")\r\n-\r\n-    def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-            i += 1\r\n-\r\n-        if i >= len(tokens):\r\n-            return i\r\n-\r\n-        line, col, ttype, first = tokens[i]\r\n-\r\n-        schema = \"dbo\"\r\n-        table_name = first.strip('[]')\r\n-\r\n-        if i + 2 < len(tokens):\r\n-            if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                schema = table_name.upper()\r\n-                table_name = tokens[i + 2][3].strip('[]')\r\n-                i += 2\r\n-\r\n-        schema = schema.upper()\r\n-        table_name = table_name.upper()\r\n-\r\n-        full_table_name = f\"{schema.upper()}.{table_name.upper()}\"\r\n-\r\n-        if self.symbol_table.has_table(table_name, schema):\r\n-            self.add_error(line, col,\r\n-                f\"Table '{table_name}' already exists\", \"WARNING\")\r\n-        else:\r\n-            table = Table(table_name, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            i = self._parse_columns(tokens, i + 1, table)\r\n-\r\n-        return i\r\n-\r\n-    def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n-        i = start\r\n-\r\n-        while i < len(tokens):\r\n-            line, col, ttype, text = tokens[i]\r\n-\r\n-            if text == ')':\r\n-                break\r\n-\r\n-            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                col_name = text.strip('[]')\r\n-\r\n-                if \"'\" in col_name:\r\n-                    self.add_error(line, col,\r\n-                        f\"Column name '{col_name}' contains apostrophe - consider using bracket notation\",\r\n-                        \"WARNING\")\r\n-\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    line2, col2, ttype2, dtype = tokens[i]\r\n-\r\n-                    valid_types = [\"INT\", \"BIGINT\", \"NVARCHAR\", \"VARCHAR\", \"CHAR\",\r\n-                                 \"DATETIME\", \"DATE\", \"BIT\", \"FLOAT\", \"DECIMAL\",\r\n-                                 \"VARBINARY\", \"BINARY\", \"TINYINT\", \"SMALLINT\",\r\n-                                 \"MONEY\", \"SMALLMONEY\", \"REAL\", \"NUMERIC\"]\r\n-\r\n-                    dtype_clean = dtype.strip('[]').upper()\r\n-\r\n-                    if ttype2 in [\"KEYWORD\", \"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                        if dtype_clean not in valid_types and dtype.upper() not in valid_types:\r\n-                            self.add_error(line2, col2,\r\n-                                f\"Unknown data type '{dtype}'\", \"WARNING\")\r\n-\r\n-                    nullable = True\r\n-                    i += 1\r\n-                    while i < len(tokens) and tokens[i][2] == \"KEYWORD\":\r\n-                        if tokens[i][3].upper() == \"NOT\":\r\n-                            nullable = False\r\n-                        i += 1\r\n-\r\n-                    column = Column(col_name, dtype_clean, nullable)\r\n-                    table.add_column(column)\r\n-\r\n-            i += 1\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_alter_table(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze ALTER TABLE statement\"\"\"\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-            i += 1\r\n-\r\n-        if i >= len(tokens):\r\n-            return i\r\n-\r\n-        line, col, ttype, table_name = tokens[i]\r\n-        raw_name = table_name.strip('[]')\r\n-\r\n-        schema = \"dbo\"\r\n-        if '.' in raw_name:\r\n-            parts = raw_name.split('.')\r\n-            schema = parts[0].upper()\r\n-            table_name_clean = parts[1].upper()\r\n-        else:\r\n-            table_name_clean = raw_name.upper()\r\n-\r\n-        if not self.symbol_table.has_table(table_name_clean, schema):\r\n-            table = Table(table_name_clean, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            self.add_error(\r\n-                line, col,\r\n-                f\"Table '{table_name_clean}' assumed to exist (ALTER without CREATE)\",\r\n-                \"WARNING\"\r\n-            )\r\n-\r\n-        i += 1\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"ADD\":\r\n-                i += 1\r\n-                if i < len(tokens) and tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                    col_line, col_col, col_type, col_name = tokens[i]\r\n-                    col_name_clean = col_name.strip('[]').upper()\r\n-\r\n-                    table = self.symbol_table.get_table(table_name_clean) or self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n-                    if table and table.has_column(col_name_clean):\r\n-                        self.add_error(col_line, col_col,\r\n-                            f\"Column '{col_name}' already exists in table '{table_name}'\",\r\n-                            \"WARNING\")\r\n-                    elif table:\r\n-                        i += 1\r\n-                        if i < len(tokens):\r\n-                            dtype = tokens[i][3]\r\n-                            column = Column(col_name_clean, dtype)\r\n-                            table.add_column(column)\r\n-            i += 1\r\n-            if i - 1 < len(tokens):\r\n-                token_text = tokens[i - 1][3]\r\n-                if token_text == ';' or token_text.upper() == \"GO\":\r\n-                    break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_update(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze UPDATE statement\"\"\"\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens):\r\n-            line, col, ttype, table_name = tokens[i]\r\n-            raw_name = table_name.strip('[]')\r\n-\r\n-            schema = \"dbo\"\r\n-            if '.' in raw_name:\r\n-                parts = raw_name.split('.')\r\n-                schema = parts[0].upper()\r\n-                table_name_clean = parts[1].upper()\r\n-            else:\r\n-                table_name_clean = raw_name.upper()\r\n-\r\n-        if not self.symbol_table.has_table(table_name_clean, schema):\r\n-            table = Table(table_name_clean, schema)\r\n-            self.symbol_table.add_table(table)\r\n-\r\n-            self.add_error(\r\n-                line, col,\r\n-                f\"Table '{table_name_clean}' assumed to exist (UPDATE without CREATE)\",\r\n-                \"WARNING\"\r\n-            )\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"SET\":\r\n-                i += 1\r\n-                # Check all columns in SET clause\r\n-                while i < len(tokens):\r\n-                    if tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n-                        col_line, col_col, _, col_name = tokens[i]\r\n-                        col_name_clean = col_name.strip('[]').upper()\r\n-\r\n-                        table = (\r\n-                            self.symbol_table.get_table(table_name_clean) or\r\n-                            self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n-                        )\r\n-\r\n-                        if table and not table.has_column(col_name_clean):\r\n-                            self.add_error(\r\n-                                col_line, col_col,\r\n-                                f\"Column '{col_name}' does not exist in table '{table_name}'\",\r\n-                                \"ERROR\"\r\n-                            )\r\n-\r\n-                    # Stop at WHERE or ;\r\n-                    if i < len(tokens):\r\n-                        token_text = tokens[i][3] if len(tokens[i]) > 3 else ''\r\n-                        if token_text in [';'] or token_text.upper() in ['WHERE', 'GO']:\r\n-                            break\r\n-\r\n-                    i += 1\r\n-                break\r\n-\r\n-            i += 1\r\n-            if i > 0 and i - 1 < len(tokens) and tokens[i - 1][3] in [';', 'GO']:\r\n-                break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        while i < len(tokens):\r\n-            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    line, col, ttype, table_name = tokens[i]\r\n-\r\n-                    schema = \"DBO\"\r\n-                    table_name_clean = \"\"\r\n-\r\n-                    # schema.table (sys.columns, dbo.users, ...)\r\n-                    if i + 2 < len(tokens) and tokens[i + 1][3] == '.':\r\n-                        schema = tokens[i][3].strip('[]').upper()\r\n-                        table_name_clean = tokens[i + 2][3].strip('[]').upper()\r\n-                        i += 2\r\n-                    else:\r\n-                        table_name_clean = tokens[i][3].strip('[]').upper()\r\n-\r\n-                    if schema.upper() in [\"SYS\", \"INFORMATION_SCHEMA\"]:\r\n-                        i += 1\r\n-                        continue\r\n-\r\n-                    if table_name_clean in [\"COLUMNS\", \"FOREIGN_KEYS\", \"TABLES\", \"OBJECTS\"]:\r\n-                        i += 1\r\n-                        continue\r\n-\r\n-                    if (not self.symbol_table.has_table(table_name_clean, schema) and\r\n-                        not self.symbol_table.has_table(table_name_clean, \"DBO\")):\r\n-                        self.add_error(line, col,\r\n-                            f\"Table '{schema}.{table_name_clean}' does not exist\", \"WARNING\")\r\n-\r\n-            i += 1\r\n-            if i > 0 and tokens[i - 1][3] in [';', ')']:\r\n-                break\r\n-\r\n-        return i\r\n-\r\n-    def _analyze_declare(self, tokens: List[Tuple], start: int) -> int:\r\n-        \"\"\"Analyze DECLARE statement\"\"\"\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n-            line, col, ttype, var_name = tokens[i]\r\n-\r\n-            if self.symbol_table.has_variable(var_name):\r\n-                self.add_error(line, col,\r\n-                    f\"Variable '{var_name}' already declared\", \"WARNING\")\r\n-            else:\r\n-                i += 1\r\n-                if i < len(tokens):\r\n-                    dtype = tokens[i][3]\r\n-                    self.symbol_table.add_variable(Variable(var_name, dtype))\r\n-\r\n-        return i + 1\r\n-\r\n-    def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n-        i = start + 1\r\n-\r\n-        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n-            line, col, ttype, var_name = tokens[i]\r\n-\r\n-            if not self.symbol_table.has_variable(var_name):\r\n-                self.add_error(line, col,\r\n-                    f\"Variable '{var_name}' not declared\", \"ERROR\")\r\n-            else:\r\n-                variable = self.symbol_table.get_variable(var_name)\r\n-                variable.initialized = True\r\n-\r\n-        return i + 1\r\n-\r\n-    def generate_report(self) -> str:\r\n-        \"\"\"Generate analysis report\"\"\"\r\n-        report = []\r\n-        report.append(\"=\" * 80)\r\n-        report.append(\"SEMANTIC ANALYSIS REPORT\".center(80))\r\n-        report.append(\"=\" * 80)\r\n-        report.append(\"\")\r\n-\r\n-        if self.stats['total_literals'] > 0:\r\n-            report.append(\"Literal Statistics:\")\r\n-            report.append(f\"  • Total Literals: {self.stats['total_literals']}\")\r\n-            report.append(f\"  • Regular Strings: {self.stats['regular_strings']}\")\r\n-            report.append(f\"  • Hex Strings: {self.stats['hex_strings']}\")\r\n-            report.append(f\"  • Bit Strings: {self.stats['bit_strings']}\")\r\n-            report.append(f\"  • Numbers: {self.stats['numbers']}\")\r\n-            report.append(\"\")\r\n-\r\n-        report.append(f\"Tables Defined: {len(self.symbol_table.tables)}\")\r\n-        for table_name, table in self.symbol_table.tables.items():\r\n-            if not table_name.startswith(\"SYS.\") and not table_name.startswith(\"INFORMATION_SCHEMA.\"):\r\n-                report.append(f\"  • {table.schema}.{table.name} ({len(table.columns)} columns)\")\r\n-                for col_name, col in table.columns.items():\r\n-                    null_str = \"NULL\" if col.nullable else \"NOT NULL\"\r\n-                    report.append(f\"      - {col.name}: {col.data_type} {null_str}\")\r\n-        report.append(\"\")\r\n-\r\n-        report.append(f\"Variables Declared: {len(self.symbol_table.variables)}\")\r\n-        for var in self.symbol_table.variables.values():\r\n-            init_str = \"initialized\" if var.initialized else \"not initialized\"\r\n-            report.append(f\"  • {var.name}: {var.data_type} ({init_str})\")\r\n-        report.append(\"\")\r\n-\r\n-        if self.errors:\r\n-            report.append(f\"ERRORS: {len(self.errors)}\")\r\n-            for error in self.errors:\r\n-                report.append(f\"  ✗ {error}\")\r\n-            report.append(\"\")\r\n-\r\n-        if self.warnings:\r\n-            report.append(f\"WARNINGS: {len(self.warnings)}\")\r\n-            for warning in self.warnings:\r\n-                report.append(f\"  ⚠ {warning}\")\r\n-            report.append(\"\")\r\n-\r\n-        if not self.errors:\r\n-            report.append(\"✓ No semantic errors found!\")\r\n-\r\n-        report.append(\"=\" * 80)\r\n-\r\n\\ No newline at end of file\n-        return \"\\n\".join(report)\n"
                }
            ],
            "date": 1768913356023,
            "name": "Commit-0",
            "content": "from typing import List, Tuple\r\nfrom dataclasses import dataclass\r\nfrom .symbol_table import SymbolTable, Table, Column, Variable\r\n\r\n\r\n@dataclass\r\nclass SemanticError:\r\n    line: int\r\n    column: int\r\n    message: str\r\n    severity: str = \"ERROR\"\r\n\r\n    def __str__(self):\r\n        return f\"[{self.severity}] Line {self.line}, Col {self.column}: {self.message}\"\r\n\r\n\r\nclass SemanticAnalyzer:\r\n\r\n    def __init__(self):\r\n        self.symbol_table = SymbolTable()\r\n        self.errors: List[SemanticError] = []\r\n        self.warnings: List[SemanticError] = []\r\n\r\n        self.stats = {\r\n            'hex_strings': 0,\r\n            'bit_strings': 0,\r\n            'regular_strings': 0,\r\n            'numbers': 0,\r\n            'total_literals': 0\r\n        }\r\n\r\n    def add_error(self, line: int, column: int, message: str, severity: str = \"ERROR\"):\r\n        \"\"\"Add an error or warning\"\"\"\r\n        error = SemanticError(line, column, message, severity)\r\n        if severity == \"ERROR\":\r\n            self.errors.append(error)\r\n        elif severity == \"WARNING\":\r\n            self.warnings.append(error)\r\n\r\n    def analyze_tokens(self, tokens: List[Tuple]):\r\n        \"\"\"Analyze a list of tokens\"\"\"\r\n        i = 0\r\n        while i < len(tokens):\r\n            line, col, ttype, text = tokens[i]\r\n\r\n            # Track literal statistics\r\n            if ttype == \"HEX_STRING\":\r\n                self.stats['hex_strings'] += 1\r\n                self.stats['total_literals'] += 1\r\n                self._validate_hex_string(line, col, text)\r\n\r\n            elif ttype == \"BIT_STRING\":\r\n                self.stats['bit_strings'] += 1\r\n                self.stats['total_literals'] += 1\r\n                self._validate_bit_string(line, col, text)\r\n\r\n            elif ttype in [\"STRING_SINGLE\", \"STRING_DOUBLE\"]:\r\n                self.stats['regular_strings'] += 1\r\n                self.stats['total_literals'] += 1\r\n\r\n            elif ttype == \"NUMBER\":\r\n                self.stats['numbers'] += 1\r\n                self.stats['total_literals'] += 1\r\n\r\n            # Analyze statements\r\n            if ttype == \"KEYWORD\" and text.upper() == \"CREATE\":\r\n                i = self._analyze_create_table(tokens, i)\r\n\r\n            elif ttype == \"KEYWORD\" and text.upper() == \"ALTER\":\r\n                i = self._analyze_alter_table(tokens, i)\r\n\r\n            elif ttype == \"KEYWORD\" and text.upper() == \"UPDATE\":\r\n                i = self._analyze_update(tokens, i)\r\n\r\n            elif ttype == \"KEYWORD\" and text.upper() == \"SELECT\":\r\n                i = self._analyze_select(tokens, i)\r\n\r\n            elif ttype == \"KEYWORD\" and text.upper() == \"DECLARE\":\r\n                i = self._analyze_declare(tokens, i)\r\n\r\n            elif ttype == \"KEYWORD\" and text.upper() == \"SET\":\r\n                i = self._analyze_set(tokens, i)\r\n\r\n            i += 1\r\n\r\n        return self.errors, self.warnings\r\n\r\n    def _validate_hex_string(self, line: int, col: int, text: str):\r\n        \"\"\"Validate hex string format\"\"\"\r\n        hex_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n\r\n        valid_hex = set('0123456789abcdefABCDEF')\r\n        invalid_chars = [c for c in hex_part if c not in valid_hex]\r\n\r\n        if invalid_chars:\r\n            self.add_error(line, col,\r\n                f\"Invalid characters in hex string: {set(invalid_chars)}\",\r\n                \"ERROR\")\r\n\r\n        if len(hex_part) % 2 != 0:\r\n            self.add_error(line, col,\r\n                f\"Hex string length must be even (got {len(hex_part)} digits)\",\r\n                \"WARNING\")\r\n\r\n    def _validate_bit_string(self, line: int, col: int, text: str):\r\n        \"\"\"Validate bit string format\"\"\"\r\n        bit_part = text[2:].replace('\\\\', '').replace('\\n', '').replace('\\r', '')\r\n\r\n        invalid_chars = [c for c in bit_part if c not in '01']\r\n\r\n        if invalid_chars:\r\n            self.add_error(line, col,\r\n                f\"Invalid characters in bit string: {set(invalid_chars)}\",\r\n                \"ERROR\")\r\n\r\n    def _analyze_create_table(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze CREATE TABLE statement\"\"\"\r\n        i = start + 1\r\n\r\n        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n            i += 1\r\n\r\n        if i >= len(tokens):\r\n            return i\r\n\r\n        line, col, ttype, first = tokens[i]\r\n\r\n        schema = \"dbo\"\r\n        table_name = first.strip('[]')\r\n\r\n        # check for schema.table\r\n        if i + 2 < len(tokens):\r\n            if tokens[i + 1][3] == '.' and tokens[i + 2][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                schema = table_name.upper()\r\n                table_name = tokens[i + 2][3].strip('[]')\r\n                i += 2\r\n\r\n        schema = schema.upper()\r\n        table_name = table_name.upper()\r\n\r\n        full_table_name = f\"{schema.upper()}.{table_name.upper()}\"\r\n\r\n        if self.symbol_table.has_table(table_name, schema):\r\n            self.add_error(line, col,\r\n                f\"Table '{table_name}' already exists\", \"WARNING\")\r\n        else:\r\n            table = Table(table_name, schema)\r\n            self.symbol_table.add_table(table)\r\n\r\n            i = self._parse_columns(tokens, i + 1, table)\r\n\r\n        return i\r\n\r\n    def _parse_columns(self, tokens: List[Tuple], start: int, table: Table) -> int:\r\n        \"\"\"Parse column definitions\"\"\"\r\n        i = start\r\n\r\n        while i < len(tokens):\r\n            line, col, ttype, text = tokens[i]\r\n\r\n            if text == ')':\r\n                break\r\n\r\n            if ttype in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                col_name = text.strip('[]')\r\n\r\n                if \"'\" in col_name:\r\n                    self.add_error(line, col,\r\n                        f\"Column name '{col_name}' contains apostrophe - consider using bracket notation\",\r\n                        \"WARNING\")\r\n\r\n                i += 1\r\n                if i < len(tokens):\r\n                    line2, col2, ttype2, dtype = tokens[i]\r\n\r\n                    valid_types = [\"INT\", \"BIGINT\", \"NVARCHAR\", \"VARCHAR\", \"CHAR\",\r\n                                 \"DATETIME\", \"DATE\", \"BIT\", \"FLOAT\", \"DECIMAL\",\r\n                                 \"VARBINARY\", \"BINARY\", \"TINYINT\", \"SMALLINT\",\r\n                                 \"MONEY\", \"SMALLMONEY\", \"REAL\", \"NUMERIC\"]\r\n\r\n                    dtype_clean = dtype.strip('[]').upper()\r\n\r\n                    if ttype2 in [\"KEYWORD\", \"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                        if dtype_clean not in valid_types and dtype.upper() not in valid_types:\r\n                            self.add_error(line2, col2,\r\n                                f\"Unknown data type '{dtype}'\", \"WARNING\")\r\n\r\n                    nullable = True\r\n                    i += 1\r\n                    while i < len(tokens) and tokens[i][2] == \"KEYWORD\":\r\n                        if tokens[i][3].upper() == \"NOT\":\r\n                            nullable = False\r\n                        i += 1\r\n\r\n                    column = Column(col_name, dtype_clean, nullable)\r\n                    table.add_column(column)\r\n\r\n            i += 1\r\n\r\n        return i\r\n\r\n    def _analyze_alter_table(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze ALTER TABLE statement\"\"\"\r\n        i = start + 1\r\n\r\n        while i < len(tokens) and tokens[i][2] not in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n            i += 1\r\n\r\n        if i >= len(tokens):\r\n            return i\r\n\r\n        line, col, ttype, table_name = tokens[i]\r\n        raw_name = table_name.strip('[]')\r\n\r\n        # Parse schema if exists\r\n        schema = \"dbo\"\r\n        if '.' in raw_name:\r\n            parts = raw_name.split('.')\r\n            schema = parts[0].upper()\r\n            table_name_clean = parts[1].upper()\r\n        else:\r\n            table_name_clean = raw_name.upper()\r\n\r\n        if not self.symbol_table.has_table(table_name_clean, schema):\r\n            table = Table(table_name_clean, schema)\r\n            self.symbol_table.add_table(table)\r\n\r\n            self.add_error(\r\n                line, col,\r\n                f\"Table '{table_name_clean}' assumed to exist (ALTER without CREATE)\",\r\n                \"WARNING\"\r\n            )\r\n\r\n        i += 1\r\n        while i < len(tokens):\r\n            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"ADD\":\r\n                i += 1\r\n                if i < len(tokens) and tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                    col_line, col_col, col_type, col_name = tokens[i]\r\n                    col_name_clean = col_name.strip('[]').upper()\r\n\r\n                    table = self.symbol_table.get_table(table_name_clean) or self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n                    if table and table.has_column(col_name_clean):\r\n                        self.add_error(col_line, col_col,\r\n                            f\"Column '{col_name}' already exists in table '{table_name}'\",\r\n                            \"WARNING\")\r\n                    elif table:\r\n                        i += 1\r\n                        if i < len(tokens):\r\n                            dtype = tokens[i][3]\r\n                            column = Column(col_name_clean, dtype)\r\n                            table.add_column(column)\r\n            i += 1\r\n            if i - 1 < len(tokens):\r\n                token_text = tokens[i - 1][3]\r\n                if token_text == ';' or token_text.upper() == \"GO\":\r\n                    break\r\n\r\n        return i\r\n\r\n    def _analyze_update(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze UPDATE statement\"\"\"\r\n        i = start + 1\r\n\r\n        if i < len(tokens):\r\n            line, col, ttype, table_name = tokens[i]\r\n            raw_name = table_name.strip('[]')\r\n\r\n            # Parse schema if exists\r\n            schema = \"dbo\"\r\n            if '.' in raw_name:\r\n                parts = raw_name.split('.')\r\n                schema = parts[0].upper()\r\n                table_name_clean = parts[1].upper()\r\n            else:\r\n                table_name_clean = raw_name.upper()\r\n\r\n        if not self.symbol_table.has_table(table_name_clean, schema):\r\n            table = Table(table_name_clean, schema)\r\n            self.symbol_table.add_table(table)\r\n\r\n            self.add_error(\r\n                line, col,\r\n                f\"Table '{table_name_clean}' assumed to exist (UPDATE without CREATE)\",\r\n                \"WARNING\"\r\n            )\r\n        while i < len(tokens):\r\n            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"SET\":\r\n                i += 1\r\n                # Check all columns in SET clause\r\n                while i < len(tokens):\r\n                    if tokens[i][2] in [\"IDENTIFIER\", \"BRACKET_IDENTIFIER\"]:\r\n                        col_line, col_col, _, col_name = tokens[i]\r\n                        col_name_clean = col_name.strip('[]').upper()\r\n\r\n                        table = (\r\n                            self.symbol_table.get_table(table_name_clean) or\r\n                            self.symbol_table.get_table(table_name_clean, \"DBO\")\r\n                        )\r\n\r\n                        if table and not table.has_column(col_name_clean):\r\n                            self.add_error(\r\n                                col_line, col_col,\r\n                                f\"Column '{col_name}' does not exist in table '{table_name}'\",\r\n                                \"ERROR\"\r\n                            )\r\n\r\n                    # Stop at WHERE or ;\r\n                    if i < len(tokens):\r\n                        token_text = tokens[i][3] if len(tokens[i]) > 3 else ''\r\n                        if token_text in [';'] or token_text.upper() in ['WHERE', 'GO']:\r\n                            break\r\n\r\n                    i += 1\r\n                break\r\n\r\n            i += 1\r\n            if i > 0 and i - 1 < len(tokens) and tokens[i - 1][3] in [';', 'GO']:\r\n                break\r\n\r\n        return i\r\n\r\n    def _analyze_select(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze SELECT statement\"\"\"\r\n        i = start + 1\r\n\r\n        while i < len(tokens):\r\n            if tokens[i][2] == \"KEYWORD\" and tokens[i][3].upper() == \"FROM\":\r\n                i += 1\r\n                if i < len(tokens):\r\n                    line, col, ttype, table_name = tokens[i]\r\n\r\n                    schema = \"DBO\"\r\n                    table_name_clean = \"\"\r\n\r\n                    # schema.table (sys.columns, dbo.users, ...)\r\n                    if i + 2 < len(tokens) and tokens[i + 1][3] == '.':\r\n                        schema = tokens[i][3].strip('[]').upper()\r\n                        table_name_clean = tokens[i + 2][3].strip('[]').upper()\r\n                        i += 2\r\n                    else:\r\n                        table_name_clean = tokens[i][3].strip('[]').upper()\r\n\r\n                    if schema.upper() in [\"SYS\", \"INFORMATION_SCHEMA\"]:\r\n                        i += 1\r\n                        continue\r\n\r\n                    if table_name_clean in [\"COLUMNS\", \"FOREIGN_KEYS\", \"TABLES\", \"OBJECTS\"]:\r\n                        i += 1\r\n                        continue\r\n\r\n                    if (not self.symbol_table.has_table(table_name_clean, schema) and\r\n                        not self.symbol_table.has_table(table_name_clean, \"DBO\")):\r\n                        self.add_error(line, col,\r\n                            f\"Table '{schema}.{table_name_clean}' does not exist\", \"WARNING\")\r\n\r\n            i += 1\r\n            if i > 0 and tokens[i - 1][3] in [';', ')']:\r\n                break\r\n\r\n        return i\r\n\r\n    def _analyze_declare(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze DECLARE statement\"\"\"\r\n        i = start + 1\r\n\r\n        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n            line, col, ttype, var_name = tokens[i]\r\n\r\n            if self.symbol_table.has_variable(var_name):\r\n                self.add_error(line, col,\r\n                    f\"Variable '{var_name}' already declared\", \"WARNING\")\r\n            else:\r\n                i += 1\r\n                if i < len(tokens):\r\n                    dtype = tokens[i][3]\r\n                    self.symbol_table.add_variable(Variable(var_name, dtype))\r\n\r\n        return i + 1\r\n\r\n    def _analyze_set(self, tokens: List[Tuple], start: int) -> int:\r\n        \"\"\"Analyze SET statement\"\"\"\r\n        i = start + 1\r\n\r\n        if i < len(tokens) and tokens[i][2] == \"VARIABLE\":\r\n            line, col, ttype, var_name = tokens[i]\r\n\r\n            if not self.symbol_table.has_variable(var_name):\r\n                self.add_error(line, col,\r\n                    f\"Variable '{var_name}' not declared\", \"ERROR\")\r\n            else:\r\n                variable = self.symbol_table.get_variable(var_name)\r\n                variable.initialized = True\r\n\r\n        return i + 1\r\n\r\n    def generate_report(self) -> str:\r\n        \"\"\"Generate analysis report\"\"\"\r\n        report = []\r\n        report.append(\"=\" * 80)\r\n        report.append(\"SEMANTIC ANALYSIS REPORT\".center(80))\r\n        report.append(\"=\" * 80)\r\n        report.append(\"\")\r\n\r\n        if self.stats['total_literals'] > 0:\r\n            report.append(\"Literal Statistics:\")\r\n            report.append(f\"  • Total Literals: {self.stats['total_literals']}\")\r\n            report.append(f\"  • Regular Strings: {self.stats['regular_strings']}\")\r\n            report.append(f\"  • Hex Strings: {self.stats['hex_strings']}\")\r\n            report.append(f\"  • Bit Strings: {self.stats['bit_strings']}\")\r\n            report.append(f\"  • Numbers: {self.stats['numbers']}\")\r\n            report.append(\"\")\r\n\r\n        report.append(f\"Tables Defined: {len(self.symbol_table.tables)}\")\r\n        for table_name, table in self.symbol_table.tables.items():\r\n            if not table_name.startswith(\"SYS.\") and not table_name.startswith(\"INFORMATION_SCHEMA.\"):\r\n                report.append(f\"  • {table.schema}.{table.name} ({len(table.columns)} columns)\")\r\n                for col_name, col in table.columns.items():\r\n                    null_str = \"NULL\" if col.nullable else \"NOT NULL\"\r\n                    report.append(f\"      - {col.name}: {col.data_type} {null_str}\")\r\n        report.append(\"\")\r\n\r\n        report.append(f\"Variables Declared: {len(self.symbol_table.variables)}\")\r\n        for var in self.symbol_table.variables.values():\r\n            init_str = \"initialized\" if var.initialized else \"not initialized\"\r\n            report.append(f\"  • {var.name}: {var.data_type} ({init_str})\")\r\n        report.append(\"\")\r\n\r\n        if self.errors:\r\n            report.append(f\"ERRORS: {len(self.errors)}\")\r\n            for error in self.errors:\r\n                report.append(f\"  ✗ {error}\")\r\n            report.append(\"\")\r\n\r\n        if self.warnings:\r\n            report.append(f\"WARNINGS: {len(self.warnings)}\")\r\n            for warning in self.warnings:\r\n                report.append(f\"  ⚠ {warning}\")\r\n            report.append(\"\")\r\n\r\n        if not self.errors:\r\n            report.append(\"✓ No semantic errors found!\")\r\n\r\n        report.append(\"=\" * 80)\r\n\r\n        return \"\\n\".join(report)"
        }
    ]
}