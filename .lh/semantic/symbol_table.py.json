{
    "sourceFile": "semantic/symbol_table.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1768913429293,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768913434970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,9 +76,8 @@\n         full_name = f\"{schema.upper()}.{name.upper()}\"\r\n         return self.tables.get(full_name)\r\n \r\n     def has_table(self, name: str, schema: str = \"dbo\") -> bool:\r\n-        \"\"\"Check if a table exists\"\"\"\r\n         full_name = f\"{schema.upper()}.{name.upper()}\"\r\n         return full_name in self.tables\r\n \r\n     def add_variable(self, variable: Variable):\r\n"
                }
            ],
            "date": 1768913429293,
            "name": "Commit-0",
            "content": "from typing import Dict, List\r\nfrom dataclasses import dataclass, field\r\n\r\n\r\n@dataclass\r\nclass Column:\r\n    name: str\r\n    data_type: str\r\n    nullable: bool = True\r\n    is_primary_key: bool = False\r\n    is_foreign_key: bool = False\r\n\r\n    def __hash__(self):\r\n        return hash(self.name.upper())\r\n\r\n    def __eq__(self, other):\r\n        if isinstance(other, Column):\r\n            return self.name.upper() == other.name.upper()\r\n        return False\r\n\r\n\r\n@dataclass\r\nclass Table:\r\n    name: str\r\n    schema: str = \"dbo\"\r\n    columns: Dict[str, Column] = field(default_factory=dict)\r\n    constraints: List[str] = field(default_factory=list)\r\n\r\n    def add_column(self, column: Column):\r\n        self.columns[column.name.upper()] = column\r\n\r\n    def has_column(self, column_name: str) -> bool:\r\n        return column_name.upper() in self.columns\r\n\r\n    def get_column(self, column_name: str) -> Column:\r\n        return self.columns.get(column_name.upper())\r\n\r\n\r\n@dataclass\r\nclass Variable:\r\n    name: str\r\n    data_type: str\r\n    initialized: bool = False\r\n\r\n\r\nclass SymbolTable:\r\n\r\n    def __init__(self):\r\n        self.tables: Dict[str, Table] = {}\r\n        self.variables: Dict[str, Variable] = {}\r\n        self.current_scope = \"GLOBAL\"\r\n        self._init_system_tables()\r\n\r\n    def _init_system_tables(self):\r\n        \"\"\"Initialize system tables\"\"\"\r\n        sys_columns = Table(\"columns\", \"sys\")\r\n        sys_columns.add_column(Column(\"Name\", \"nvarchar\"))\r\n        sys_columns.add_column(Column(\"Object_ID\", \"int\"))\r\n        sys_columns.add_column(Column(\"column_id\", \"int\"))\r\n        self.tables[\"SYS.COLUMNS\"] = sys_columns\r\n        sys_fk = Table(\"foreign_keys\", \"sys\")\r\n        sys_fk.add_column(Column(\"name\", \"nvarchar\"))\r\n        sys_fk.add_column(Column(\"object_id\", \"int\"))\r\n        sys_fk.add_column(Column(\"parent_object_id\", \"int\"))\r\n        self.tables[\"SYS.FOREIGN_KEYS\"] = sys_fk\r\n        info_tables = Table(\"TABLES\", \"INFORMATION_SCHEMA\")\r\n        info_tables.add_column(Column(\"TABLE_SCHEMA\", \"nvarchar\"))\r\n        info_tables.add_column(Column(\"TABLE_NAME\", \"nvarchar\"))\r\n        info_tables.add_column(Column(\"TABLE_TYPE\", \"nvarchar\"))\r\n        self.tables[\"INFORMATION_SCHEMA.TABLES\"] = info_tables\r\n\r\n    def add_table(self, table: Table):\r\n        \"\"\"Add a table to the symbol table\"\"\"\r\n        full_name = f\"{table.schema.upper()}.{table.name.upper()}\"\r\n        self.tables[full_name] = table\r\n\r\n    def get_table(self, name: str, schema: str = \"dbo\") -> Table:\r\n        full_name = f\"{schema.upper()}.{name.upper()}\"\r\n        return self.tables.get(full_name)\r\n\r\n    def has_table(self, name: str, schema: str = \"dbo\") -> bool:\r\n        \"\"\"Check if a table exists\"\"\"\r\n        full_name = f\"{schema.upper()}.{name.upper()}\"\r\n        return full_name in self.tables\r\n\r\n    def add_variable(self, variable: Variable):\r\n        \"\"\"Add a variable to the symbol table\"\"\"\r\n        self.variables[variable.name.upper()] = variable\r\n\r\n    def get_variable(self, name: str) -> Variable:\r\n        \"\"\"Get a variable from the symbol table\"\"\"\r\n        return self.variables.get(name.upper())\r\n\r\n    def has_variable(self, name: str) -> bool:\r\n        \"\"\"Check if a variable exists\"\"\"\r\n        return name.upper() in self.variables\r\n"
        }
    ]
}