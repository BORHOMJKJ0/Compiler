{
    "sourceFile": "NULL_ANALYSIS_REPORT.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1769013116778,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1769013116778,
            "name": "Commit-0",
            "content": "# AST Null Values Analysis Report\n\n## Executive Summary\n\nTotal test results across all SQL files:\n- **Total statements:** 41\n- **Statements with nulls:** 30 (73.2%)\n- **Total null occurrences:** 237\n- **Unique null field paths:** 53\n\n## Critical Findings\n\n### 1. EXPECTED/ACCEPTABLE NULLS ✓\n\nThese nulls are **normal and correct** - they represent optional SQL clauses:\n\n| Field | Count | Reason |\n|-------|-------|--------|\n| `orderByClause` | 15 | Optional - not all SELECT statements have ORDER BY |\n| `whereClause` | 10 | Optional - not all SELECT statements have WHERE |\n| `fromClause` | 1 | Optional - some statements don't need FROM |\n| `table_name` in expressions | 25+ | Optional - column references without table prefix |\n| `keywordAs` in selectList items | 16 | Optional - aliases not always present |\n| `selectStatement.identifier` | 16 | Optional - aliases not always used |\n\n### 2. PROBLEMATIC/UNEXPECTED NULLS ⚠️\n\nThese nulls may indicate **missing data that should be populated**:\n\n| Field | Count | Issue | Example |\n|-------|-------|-------|---------|\n| `fromClause.tableSource[0].tableName.schema` | 16 | Schema always null | Should be populated when present in SQL |\n| `fromClause.tableSource[0].keyword` | 17 | Keyword not captured | \"FROM\" keyword not being stored |\n| `fromClause.tableSource[0].identifier` | 17 | Identifier not captured | Table alias not being captured |\n| `expression` in testing.sql | 4 | Missing expressions | Some expressions not being built |\n| `operator` in testing.sql | 4 | Missing operators | Binary/unary operators not captured |\n| `assignmentList[0].expression` | 1 | Missing SET clause expression | UPDATE statement not capturing value |\n| `insertColumns` / `insertValues` | 1 each | INSERT clauses empty | Column list and values not parsed |\n| `tryStatementList[0].expressionList` | 1 | Missing expression list | TRY statement expression not captured |\n\n## Detailed Analysis by File\n\n### train.sql\n- **Statements:** 25\n- **With nulls:** 17 (68%)\n- **Total nulls:** 173\n\n**Top Issues:**\n1. `fromClause.tableSource[0].keyword` - \"FROM\" keyword not being stored\n2. `fromClause.tableSource[0].identifier` - Table aliases not captured\n3. `fromClause.tableSource[0].tableName.schema` - Schema always null\n4. Optional clauses missing (orderByClause: 14, whereClause: 8) - EXPECTED\n\n**Action:** Modify `build_from_clause` and `build_table_source` to:\n- Capture the FROM keyword\n- Extract table aliases\n- Store schema information\n\n### train2.sql  \n- **Statements:** 2\n- **With nulls:** 2 (100%)\n- **Total nulls:** 13\n\n**Top Issues:**\n1. `blockStatement` - IF EXISTS block not populated (1 null)\n2. `insertColumns` / `insertValues` - INSERT statement clauses empty (1 each)\n3. `selectStatement` in INSERT - Not captured for SELECT-based INSERT\n4. Optional clauses (orderByClause, whereClause) - EXPECTED\n\n**Action:** Modify builders to:\n- Handle block statements in IF EXISTS\n- Parse INSERT...COLUMNS...VALUES properly\n- Handle INSERT...SELECT statements\n\n### testing.sql\n- **Statements:** 14  \n- **With nulls:** 11 (78.6%)\n- **Total nulls:** 51\n\n**Top Issues:**\n1. **CRITICAL:** `expression` - 4 null values in UPDATE/ALTER statements\n2. **CRITICAL:** `operator` - 4 null values (binary/unary operators not captured)\n3. `keyword2` in constraints - Constraint keywords not fully populated\n4. `assignmentList[0].expression` - UPDATE SET value not being parsed\n\n**Action:** Modify builders to:\n- Ensure all expressions are built (not left as UnknownExpression)\n- Properly handle operators in expressions\n- Parse UPDATE assignments completely\n- Handle ALTER TABLE expressions\n\n## Detailed Null Field Breakdown\n\n### Across All Files (Top 20)\n\n```\n1. fromClause.tableSource[0].keyword: 17\n   └─ The FROM keyword is not being stored\n   \n2. fromClause.tableSource[0].identifier: 17  \n   └─ Table aliases are not being captured\n   \n3. selectList[0].keywordAs: 16\n   └─ EXPECTED: AS keyword only present when alias exists\n   \n4. selectList[0].identifier: 16\n   └─ EXPECTED: Alias identifier only present when alias used\n   \n5. fromClause.tableSource[0].tableName.schema: 16\n   └─ Schema information is always null (need to parse schema.tablename)\n   \n6. orderByClause: 15\n   └─ EXPECTED: ORDER BY is optional\n   \n7. whereClause: 10\n   └─ EXPECTED: WHERE is optional\n   \n8. selectList[0].expression.table_name: 9\n   └─ EXPECTED: table_name is only populated for qualified columns (table.column)\n   \n9-14. More optional/expected nulls...\n\n15-20. testinig.sql specific nulls (expression, operator fields)\n   └─ PROBLEMATIC: These should be populated\n```\n\n## Summary of Issues to Fix\n\n### CRITICAL (Data Loss)\n1. **expressions not being built** - Some UPDATE/INSERT statements show `\"expression\": null`\n   - Fix: Ensure all expression contexts are properly handled in builders\n\n2. **operators not being captured** - Binary operators in conditions missing\n   - Fix: Ensure operator extraction in `build_expression`\n\n3. **UPDATE assignments incomplete** - SET clause values not parsed\n   - Fix: Fix UPDATE statement builder for complex expressions\n\n### HIGH (Incomplete Data)\n1. **table_name schema not extracted** - All schema values are null\n   - Fix: Parse \"schema.table\" format properly in table source builder\n\n2. **FROM keyword not stored** - Always null\n   - Fix: Store `keywordFrom` in fromClause node\n\n3. **Table aliases not captured** - Identifier always null\n   - Fix: Extract alias from table source context\n\n4. **INSERT statement incompleteness** - Missing columns and values\n   - Fix: Parse INSERT INTO table (cols) VALUES properly\n\n### MEDIUM (Better Representation)\n1. INSERT...SELECT not recognized\n   - Fix: Handle SELECT statements in INSERT context\n\n2. IF EXISTS block statements empty\n   - Fix: Parse block statement content\n\n## Recommended Fixes\n\n1. **statement_builder.py** - `build_from_clause`\n   ```python\n   # Add schema parsing\n   # Add keyword capture\n   # Add table alias capture\n   ```\n\n2. **expression_builder.py** - All expression builders\n   ```python\n   # Ensure no null expressions returned\n   # Handle all operator types\n   # Return proper node types (not UnknownExpression)\n   ```\n\n3. **statement_builder.py** - `build_update_statement`\n   ```python\n   # Parse SET clause expressions properly\n   # Build complete assignment list\n   ```\n\n4. **statement_builder.py** - `build_insert_statement`\n   ```python\n   # Parse column list\n   # Parse VALUES clause\n   # Handle INSERT...SELECT\n   ```\n"
        }
    ]
}